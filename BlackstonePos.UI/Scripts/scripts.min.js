!function(){"use strict";var e=angular.module("posApp",["ngRoute","ngAnimate","ngResource","ui.bootstrap","loginServices","sharedServices","prodsServices","LocalStorageModule","appFilters","customFunctions","promosServices","billPaymentServices","sunpassServices","directTvServices","ajoslin.promise-tracker"]);e.constant("API_URL","http://bsapi.pinserve.com/api/"),e.constant("SITE_URL","http://mobile.blackstonepos.com/"),e.config(["$routeProvider",function(e){e.when("/login",{controller:"LoginCtrl",templateUrl:"./app/login/_login.html"}).when("/",{controller:"HomeCtrl",templateUrl:"app/home/_home.html"}).when("/admin",{controller:"AdminCtrl",templateUrl:"./app/admin/_admin.html"}).when("/pos/category/promotions",{controller:"PromosCtrl",templateUrl:"app/promotions/_index-promos.html"}).when("/pos/category/:category",{controller:"IndexByCategoryCtrl",templateUrl:"app/products/_index-products.html"}).when("/pos/category/:category/amount/:amount",{controller:"IndexByCategoryCtrl",templateUrl:"app/products/_index-products.html"}).when("/pos/category/:category/countries",{controller:"IndexCountriesByCategoryCtrl",templateUrl:"app/products/_index-countries.html"}).when("/pos/category/:category/country/:country",{controller:"IndexByCategoryByCountryCtrl",templateUrl:"app/products/_index-products.html"}).when("/pos/category/:category/carriers",{controller:"IndexByCarriersCtrl",templateUrl:"app/products/_index-carriers.html"}).when("/pos/category/:category/carrier/:carrier",{controller:"IndexByCategoryByCarrierCtrl",templateUrl:"app/products/_index-products.html"}).when("/pos/category/:category/product/:id",{controller:"ShowProductCtrl",templateUrl:"app/products/_show-product.html"}).when("/billpayment/categories",{controller:"IndexCategoriesBillPaymentCtrl",templateUrl:"app/billpayment/_index-categories.html"}).when("/billpayment/category/:category",{controller:"IndexByCategoryBillPaymentCtrl",templateUrl:"app/billpayment/_index-billers.html"}).when("/billpayment/popular",{controller:"IndexByPopularBillPaymentCtrl",templateUrl:"app/billpayment/_index-categories.html"}).when("/billpayment/biller/:biller",{controller:"ShowBillPaymentCtrl",templateUrl:"app/billpayment/_show-biller.html"}).when("/sunpass/category/documents",{controller:"DocumentsSunpassCtrl",templateUrl:"app/sunpass/_documents-sunpass.html"}).when("/sunpass/category/replenish",{controller:"ReplenishSunpassCtrl",templateUrl:"app/sunpass/_replenish-sunpass.html"}).when("/sunpass",{controller:"IndexSunpassCtrl",templateUrl:"app/sunpass/_index-sunpass.html"}).when("/directtv/categories",{controller:"IndexDirectTvCategoriesCtrl",templateUrl:"app/directtv/_index-categories-dtv.html"}).when("/directtv/category/:category",{controller:"IndexDirectTvByCategoryCtrl",templateUrl:"app/directtv/_index-dtv.html"}).when("/directtv/product/:product",{controller:"showDirectTvCtrl",templateUrl:"app/directtv/_show-dtv.html"}).when("/terms/:id",{controller:"ShowTermsCtrl",templateUrl:"app/products/_show-terms.html"}).when("/others",{controller:"directTvCtrl",templateUrl:"app/directtv/_index-directtv.html"}).otherwise({redirectTo:"/login"})}]),e.run(["$rootScope","$location","AuthenticationFactory",function(e,t,r){e.$on("$routeChangeSuccess",function(){r.isLoggedIn()||t.path("/login")})}]),e.run(["$rootScope","$location",function(e,t){var r=[];e.$on("$routeChangeSuccess",function(){r.push(t.$$path)}),e.back=function(){var e=r.length>1?r.splice(-2)[0]:"/";t.path(e)}}]),e.run(["$rootScope","promiseTracker",function(e,t){e.loadingTracker=t({activationDelay:100,minDuration:350}),e.loadingMerchantTracker=t({activationDelay:100,minDuration:350}),e.loadingAdminTracker=t({activationDelay:100,minDuration:350})}]),e.config(["localStorageServiceProvider",function(e){e.setPrefix("pos")}]),e.config(["$httpProvider",function(e){e.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=utf-8",e.defaults.transformRequest=[function(e){var t=function(e){var r,n,a,o,i,c,s,u="";for(r in e)if(n=e[r],n instanceof Array)for(s=0;s<n.length;++s)i=n[s],a=r+"["+s+"]",c={},c[a]=i,u+=t(c)+"&";else if(n instanceof Object)for(o in n)i=n[o],a=r+"["+o+"]",c={},c[a]=i,u+=t(c)+"&";else void 0!==n&&null!==n&&(u+=encodeURIComponent(r)+"="+encodeURIComponent(n)+"&");return u.length?u.substr(0,u.length-1):u};return angular.isObject(e)&&"[object File]"!==String(e)?t(e):e}]}])}(),function(){"use strict";angular.module("posApp").controller("AdminCtrl",["$rootScope","$scope","$location","localStorageService","AuthenticationFactory","ExternalFactory","AdminFactory","CashierFactory","OrderFactory","SettingsFactory","AchPaymentFactory","AlertService",function(e,t,r,n,a,o,i,c,s,u,l,d){function m(e){null!=e&&(t.payment.Id=e.Id,t.payment.AccountNumber=e.AccountNumber,t.payment.RoutingNumber=e.RoutingNumber,t.payment.TypeChecking=e.TypeChecking,t.payment.SaveAccount=e.SaveAccount)}function p(e){t.editcashier.id=e.Id,t.editcashier.name=e.Name,t.editcashier.password=e.Password}var h,f,g=n.get("userInfo");t.closeAlert=function(e){t.alerts.splice(e,1)},h=g.MerchantId,f=g.MerchantPassword,t.adminLoginAlerts=[];var v=function(){t.payment={Id:0,AccountNumber:null,RoutingNumber:null,TypeChecking:!0,SaveAccount:!1,MerchantId:g.MerchantId,Amount:0},t.paymentAlerts=[]},y=function(){var e=g.IsMerchant;n.set("adminLogged",e),t.adminLogged=e},b=function(){t.settingsAlerts=[],t.settings={SmallReceipt:null,Tax:null,ConfirmPhone:null,PaxTerminalAsPrinter:null}},P=function(){t.cashierAlerts=[],t.cashier={id:null,name:null,password:null},t.editcashier={id:null,name:null,password:null}};y(),v(),P(),b(),y(),t.closePaymentAlerts=function(){t.paymentAlerts=[]},t.setSelectedPayment=function(){m(this.ach)},t.getSavedAchPayments=function(){i.getSavedAchPayments().then(function(e){t.achs=e,t.spin=!1,null!=e&&e.length>0&&m(e[0])},function(){})},t.addAchFunds=function(){i.addAchFunds(t.payment.Id,t.payment.AccountNumber,t.payment.RoutingNumber,t.payment.MerchantId,t.payment.Amount,t.payment.SaveAccount,t.payment.TypeChecking).then(function(e){var r=d.getAlertInstance(e);t.paymentAlerts.push(r),t.getSavedAchPayments()},function(){})},t.closeCashierAlerts=function(){t.cashierAlerts=[]},t.closeAdminLoginAlerts=function(){t.adminLoginAlerts=[]},t.setSelectedCashier=function(){p(this.cashier),t.editMode=!0},t.getCashiers=function(){c.getCashiers(h,f).then(function(e){t.cashiers=e},function(){})},t.deleteCashier=function(e){confirm("Are you sure you want to delete this cashier?")&&c.deleteCashier(e).then(function(e){var r=d.getAlertInstance(e);t.cashierAlerts.push(r),t.getCashiers()},function(){})},t.saveCashier=function(){c.saveCashier(t.userInfo.MerchantId,t.cashier.name,t.cashier.password).then(function(e){var r=d.getAlertInstance(e);t.cashierAlerts=[r],t.getCashiers()},function(){})},t.updateCashier=function(){c.editCashier(g.MerchantId,t.editcashier.id,t.editcashier.name,t.editcashier.password).then(function(e){var r=d.getAlertInstance(e);t.cashierAlerts=[r],t.getCashiers()},function(){})},t.currentPage=1,t.perPage=10,t.noOfPages=15,t.totalItems=0,t.maxSize=5,t.getOrders=function(){s.getOrders(t.currentPage,t.perPage).then(function(e){t.orders=e.Data,t.totalItems=e.Count,t.spin=!1},function(){})},t.pageChanged=function(e){t.currentPage=e,t.getOrders()},t.getSettings=function(){u.getSettings().then(function(e){var r=e;n.set("settings",r),t.settings=r},function(){})},t.updateSettings=function(e){return t.submitted=!0,e.$invalid?void d.clear():void(e.$valid&&u.updateSettings(g.MerchantId,t.settings.SmallReceipt,t.settings.Tax,t.settings.ConfirmPhone,t.settings.PaxTerminalAsPrinter).then(function(e){t.updateSettingsResponse=e;var r=d.getAlertInstance(e);t.settingsAlerts=[r]},function(){}))},t.closeSettingsAlerts=function(){t.settingsAlerts=[]},t.loginOverSesion=function(e){a.login(t.userInfo.MerchantId,e).then(function(e){if(200===e.Status)t.adminLogged=e.UserInfo.isMerchant;else{var r={type:"error",msg:"Invalid Admin Credentials"};t.adminLoginAlerts=[r]}},function(){var e={type:"error",msg:"Invalid Admin Credentials"};t.adminLoginAlerts.push(e)})},t.submit=function(e){t.submitted=!0,e.$invalid||e.$valid&&(d.clear(),i.addAchFunds(t.Id,t.AccountNumber,t.RoutingNumber,t.MerchantId,t.Amount,t.SaveAccount,t.TypeChecking).then(function(e){d.add("success",e)},function(e){d.add("error",e)}))},t.updateOrders=function(){t.spin=!0,t.getOrders()},t.getSettings(),t.getCashiers(),t.getOrders()}])}(),function(){"use strict";angular.module("posApp").controller("IndexByCategoryBillPaymentCtrl",["$scope","$routeParams","BillPaymentFactory","AlertService","$location",function(e,t,r,n,a){var o=t.category,i="popular"===o?"":o;e.useMostPopular=!0,e.isMostPopular="popular"===o?!0:!1,e.useAcronym=!0,e.showAcronym=!0,e.useConfig=!0,e.configPath="categories",e.configDisplay="Category",e.numLimit=25,e.type=a.path().split("/").splice(1,1).toString(),e.mostpopular="category/popular",e.getBillersInitials=function(){r.getBillersInitials(i).then(function(t){e.alpha=t},function(){})},e.getBillersByCategory=function(){r.getBillersByCategory(i).then(function(t){e.items=t},function(){})},e.getBillersInitials(),e.getBillersByCategory()}])}(),function(){"use strict";angular.module("billPaymentServices",[]).factory("BillPaymentFactory",["$http","$rootScope","API_URL","$q","SharedFunctions","localStorageService",function(e,t,r,n,a,o){var i,c=o.get("userInfo"),s={MerchantId:c.MerchantId,MerchantPassword:c.MerchantPassword},u={tracker:t.loadingTracker};return{getBillersByCategory:function(t){var a={MerchantId:s.MerchantId,MerchantPassword:s.MerchantPassword,CategoryId:t,BillerId:""},o=n.defer();return e.post(r+"BillPayment/GetBillersByCategory",a,u).then(function(e){i=e.data.Data,o.resolve(i)},function(e){o.reject(e)}),o.promise},getBillersInitials:function(t){var a={MerchantId:s.MerchantId,MerchantPassword:s.MerchantPassword,CategoryId:t,BillerId:""},o=n.defer();return e.post(r+"BillPayment/GetBillersInitials",a,u).then(function(e){i=e.data.Data,o.resolve(i)},function(e){o.reject(e)}),o.promise},getBillPaymentCategories:function(){var t={MerchantId:s.MerchantId,MerchantPassword:s.MerchantPassword},a=n.defer();return e.post(r+"BillPayment/GetBillPaymentCategories",t,u).then(function(e){i=e.data.Data,a.resolve(i)},function(e){a.reject(e)}),a.promise},getMasterBiller:function(t){var a={MerchantId:s.MerchantId,MerchantPassword:s.MerchantPassword,CategoryId:"",BillerId:t},o=n.defer();return e.post(r+"BillPayment/getMasterBiller",a,u).then(function(e){i=e.data.Data,o.resolve(i)},function(e){o.reject(e)}),o.promise},getBillerPaymentOptions:function(t){var a={MerchantId:s.MerchantId,MerchantPassword:s.MerchantPassword,CategoryId:"",BillerId:t},o=n.defer();return e.post(r+"BillPayment/GetBillerPaymentOptions",a,u).then(function(e){i=e.data.Data,o.resolve(i)},function(e){o.reject(e)}),o.promise},doBillPaymentNextStep:function(t){var a=t;a.MerchantId=s.MerchantId,a.MerchantPassword=s.MerchantPassword;var o=n.defer();return e.post(r+"BillPayment/DoBillPaymentNextStep",a,u).then(function(e){i=e.data,o.resolve(i)},function(e){o.reject(e)}),o.promise},doBillPayment:function(t){var a=t;a.MerchantId=s.MerchantId,a.MerchantPassword=s.MerchantPassword;var o=n.defer();return e.post(r+"BillPayment/DoBillPayment",a,u).then(function(e){i=e.data,o.resolve(i)},function(e){o.reject(e)}),o.promise}}}])}(),function(){"use strict";angular.module("posApp").controller("IndexByPopularBillPaymentCtrl",["$scope","$routeParams","BillPaymentFactory",function(e,t,r){e.useMostPopular=!1,e.isMostPopular=!0,e.showAcronym=!1,e.useConfig=!0,e.getBillPaymentCategories=function(){r.getBillPaymentCategories().then(function(t){e.items=t;var r=t.length;switch(r){case 2:e.thumbWidth=6;break;case 4:e.thumbWidth=6;break;case 6:e.thumbWidth=3;break;case 8:e.thumbWidth=3;break;default:e.thumbWidth=2}},function(){})},e.getBillPaymentCategories()}])}(),function(){"use strict";angular.module("posApp").controller("IndexCategoriesBillPaymentCtrl",["$scope","$routeParams","BillPaymentFactory","AlertService","$location",function(e,t,r,n,a){e.useMostPopular=!0,e.isMostPopular=!1,e.useAcronym=!1,e.useConfig=!1,e.type=a.path().split("/").splice(1,1).toString(),e.mostpopular="category/popular",e.setFilter=function(t){e.letter=t},e.showFilter=function(){e.showAcronymFilter=!e.showAcronymFilter},e.getBillPaymentCategories=function(){r.getBillPaymentCategories().then(function(t){e.items=t;var r=t.length;switch(r){case 2:e.thumbWidth=6;break;case 4:e.thumbWidth=6;break;case 6:e.thumbWidth=3;break;case 8:e.thumbWidth=3;break;default:e.thumbWidth=2}},function(){})},e.getBillPaymentCategories()}])}(),function(){"use strict";angular.module("posApp").controller("ShowBillPaymentCtrl",["$scope","$routeParams","BillPaymentFactory","AlertService",function(e,t,r,n){function a(){e.accountNumber.value||(e.accountNumber.value=""),e.accountMatch.value||(e.accountMatch.value=""),e.amount.value||(e.amount.value="")}function o(){var t=e.accountNumber.value.length,r=e.accountNumber.value;e.accountNumber.value=r.substring(0,t-1)}function i(){var t=e.accountMatch.value.length,r=e.accountMatch.value;e.accountMatch.value=r.substring(0,t-1)}function c(){var t=e.amount.value.length,r=e.amount.value;e.amount.value=r.substring(0,t-1)}function s(t){e.accountNumber.value=e.accountNumber.value+t}function u(t){e.accountMatch.value=e.accountMatch.value+t}function l(t){e.amount.value=e.amount.value+t}function d(t){e.amount.isFocused?l(t):e.accountNumber.isFocused?s(t):u(t)}e.isMostPopular=!1,e.showAcronymFilter=!1,e.useAcronymFilter=!1,e.useConfig=!1,e.numLimit=25;var m=t.biller;e.showPaymentOptions=!0,e.showPaymentDetails=!1,e.hasKeyPad=!0,e.showKeypad=!0,e.showAdditionalDataForm=!1,e.showReceipt=!1,e.isDisableInputs=!1,e.accountNumber={value:null,isFocused:!1},e.accountMatch={value:null,isFocused:!1},e.amount={value:null,isFocused:!1},e.paymentType={value:null},e.date=new Date,e.editing=null,e.editItem=function(t){e.editing=t},e.onInputClick=function(e){e.target.select()},e.setKey=function(e){a(),d(e)},e.clearKey=function(){e.accountNumber.isFocused?e.accountNumber.value="":e.amount.value=""},e.backKey=function(){a(),e.accountNumber.isFocused?o():e.amount.isFocused?c():i()},e.setFocusedInput=function(t){"amount"===t?(e.accountNumber.isFocused=!1,e.accountMatch.isFocused=!1,e.amount.isFocused=!0):"accountNumber"===t?(e.accountMatch.isFocused=!1,e.accountNumber.isFocused=!0,e.amount.isFocused=!1):"accountMatch"===t&&(e.accountNumber.isFocused=!1,e.accountMatch.isFocused=!0,e.amount.isFocused=!1)},e.leaveInputsFocus=function(){e.accountNumber.isFocused=!1,e.accountMatch.isFocused=!1,e.amount.isFocused=!1},e.setAmount=function(t){e.amount=e.amount===t?void 0:t},e.getMasterBiller=function(){r.getMasterBiller(m).then(function(t){e.item=t},function(){})},e.getBillerPaymentOptions=function(){r.getBillerPaymentOptions(m).then(function(t){e.paymentOptions=t},function(){})},e.getBillerPaymentOptions(),e.getMasterBiller(),e.parseFloat=function(e){return parseFloat(e)},e.fee="0",e.paymentType=null,e.setPaymentOption=function(t){e.fee=t.FeeAmount,e.paymentType=t.PaymentType,e.showPaymentDetails=!0},e.doBillPaymentNextStep=function(t){if(e.submitted=!0,t.$invalid)return n.clear(),void n.add("error","Check errors below (in red color)");var a={CategoryId:"",BillerId:m,AccountNumber:e.accountNumber.value,Amount:e.amount.value,PaymentFee:e.fee};r.doBillPaymentNextStep(a).then(function(t){200===t.Status?(e.showKeypad=!1,e.isDisableInputs=!0,e.aditionalDataRequired=t.Data,e.showAdditionalDataForm=!0):(n.add("error",t.ErrorMessage),e.isDisableInputs=!1)},function(){})},e.setDefaults=function(){e.customer="",e.sender="",e.altLookUp="",e.addInfo1="",e.addInfo2=""},e.setDefaults(),e.doBillPayment=function(t){if(e.submitted=!0,t.$invalid)return n.clear(),!1;var a={CategoryId:"",BillerId:m,AccountNumber:e.accountNumber.value,Amount:e.amount.value,PaymentFee:e.fee,CustomerName:e.customer,SenderName:e.sender,AltLookUp:e.altLookUp,AddInfo1:e.addInfo1,AddInfo2:e.addInfo2};r.doBillPayment(a).then(function(t){200===t.Status||203===t.Status?(e.showPaymentOptions=!1,e.showAdditionalDataForm=!1,e.showReceipt=!0,e.receipt=t.Data):(n.add("error",t.ErrorMessage),e.showKeypad=!0,e.isDisableInputs=!1,e.showAdditionalDataForm=!1)},function(){})},e.printInfo=function(){window.print()}}])}(),function(){"use strict";angular.module("posApp").controller("IndexDirectTvCategoriesCtrl",["$scope","$routeParams","DirectTvFactory","AlertService","$location",function(e,t,r,n,a){e.useMostPopular=!1,e.isMostPopular=!1,e.useAcronym=!1,e.useConfig=!1,e.type=a.path().split("/").splice(1,1).toString(),e.mostpopular="category/popular",e.getDirectTvCategories=function(){r.getDirectTvCategories().then(function(t){e.items=t},function(){})},e.getDirectTvCategories()}]).controller("IndexDirectTvByCategoryCtrl",["$scope","$routeParams","DirectTvFactory","ProdsFactory","AlertService","$location",function(e,t,r,n,a,o){e.useMostPopular=!0,e.isMostPopular=!0,e.useAcronym=!1,e.showAcronym=!0,e.useConfig=!0,e.configPath="categories",e.configDisplay="Category",e.type=o.path().split("/").splice(1,1).toString(),e.mostpopular="popular";var i=t.category;e.getDirectTvProductsByCategory=function(){r.getDirectTvProductsByCategory(i).then(function(t){e.items=t},function(){})},e.getDirectTvProductsByCategory()}]).controller("showDirectTvCtrl",["$scope","DirectTvFactory","ProdsFactory","$routeParams","AlertService","localStorageService","SharedFunctions","$modal","ConfirmationFactory",function(e,t,r,n,a,o,i,c,s){var u=n.product;e.getDirectTvProduct=function(){t.getDirectTvProduct(u).then(function(t){e.item=t},function(){})},e.getDirectTvProduct(),e.submit=function(t){if(e.submitted=!0,t.$invalid)return a.clear(),void a.add("error","Check errors below (in red color)");e.isBlocked=!0,a.clear();var n=o.get("userInfo"),i={MerchantId:n.MerchantId,MerchantPassword:n.MerchantPassword,OperatorName:n.userName,ProfileId:n.profileId,TerminalId:n.terminalId,Amount:e.item.price,ProductMainCode:e.item.id};r.doBlackstonePosOperation(i).then(function(t){if(200===t.Status||203===t.Status){var r=200===t.Status?"Order processed!":"Order placed. Pending for further Execution!";e.showReceipt=!0,e.submitted=!1,a.add("success",r),e.receipt=t.Data}else a.add("error",t.ErrorMessage),e.isBlocked=!1},function(){e.isBlocked=!1,a.add("error","Invalid Credentials")}),e.showReceipt=!1},e.printInfo=function(){window.print()},e.sendSms=function(t){if(e.submittedSms=!0,t.$invalid)return a.clear(),void a.add("error","Check form errors");a.clear();var r=e.receipt,n=e.phoneToSend;s.sendConfirmationSms(r,n).then(function(t){a.clear(),e.submittedSms=!1,200===t.Status?a.add("success","The Receipt has been sent as sms successfully!"):a.add("error","Sorry, an error has happened. Please, try again.")},function(e){a.add("error",e.ErrorMessage)})},e.sendEmail=function(t){if(e.submittedEmail=!0,t.$invalid)return a.clear(),void a.add("error","Check form errors");a.clear();var r=e.receipt,n=e.emailToSend;s.sendConfirmationEmail(r,n).then(function(t){a.clear(),e.submittedEmail=!1,200===t.Status?a.add("success","The Receipt has been sent as email successfully!"):a.add("error","Sorry, an error has happened. Please, try again.")},function(e){a.add("error",e.ErrorMessage)})},e.open=function(t){var r={firstItem:e.item.productName,secondItem:null,thirdItem:e.item.price};t=i.merge(t,r);var n=c.open({templateUrl:"./app/products/_modal-product-tpl.html",controller:"ModalInstanceCtrl",size:"lg",windowClass:"product-modal",resolve:{item:function(){return t}}});n.result.then(function(t){e.selected=t},function(){})}}])}(),function(){"use strict";angular.module("directTvServices",[]).factory("DirectTvFactory",["$http","$rootScope","API_URL","$q","SharedFunctions","localStorageService",function(e,t,r,n,a,o){var i=[],c=o.get("userInfo"),s={MerchantId:c.MerchantId,MerchantPassword:c.MerchantPassword},u={tracker:t.loadingTracker};return{getDirectTvAllProducts:function(t){var a={MerchantId:s.MerchantId,MerchantPassword:s.MerchantPassword,CategoryId:t},o=n.defer();return e.post(r+"DirectTv/GetDirectTvAllProducts",a,u).then(function(e){i=e.data.Data,o.resolve(i)},function(e){o.reject(e)}),o.promise},getDirectTvCategories:function(){var t={MerchantId:s.MerchantId,MerchantPassword:s.MerchantPassword},a=n.defer();return e.post(r+"DirectTv/GetDirectTvCategories",t,u).then(function(e){i=e.data.Data,a.resolve(i)},function(e){a.reject(e)}),a.promise},getDirectTvProductsByCategory:function(t){var a={MerchantId:s.MerchantId,MerchantPassword:s.MerchantPassword,Category:t},o=n.defer();return e.post(r+"DirectTv/GetDirectTvProductsByCategory",a,u).then(function(e){i=e.data.Data,o.resolve(i)},function(e){o.reject(e)}),o.promise},getDirectTvProduct:function(t){var a={MerchantId:s.MerchantId,MerchantPassword:s.MerchantPassword,ProductMainCode:t},o=n.defer();return e.post(r+"DirectTv/GetDirectTvProduct",a,u).then(function(e){i=e.data.Data,o.resolve(i)},function(e){o.reject(e)}),o.promise}}}])}(),function(){"use strict";angular.module("posApp").controller("HomeCtrl",["$scope","$location","AlertService","ProdsFactory","localStorageService","ExternalFactory",function(e,t,r,n,a,o){var i=a.get("userInfo");e.getActivationShopUrl=function(){o.getActivationShopUrl(i.merchantId,i.password).then(function(t){var r=t;e.activationShopUrl=r},function(){})},e.getActivationShopUrl(),e.getVonageUrl=function(){o.getVonageUrl(i.merchantId,i.password).then(function(t){var r=t;e.vonageUrl=r},function(){})};var c=[{categoryName:"billpayment",title:"Bill Payment",url:"#/billpayment/categories",position:1,icon:""},{categoryName:"international",title:"Int'l Top Up",url:"#/pos/category/international/countries",position:2,icon:""},{categoryName:"pinless",title:"Pinless Recharge",url:"#/pos/category/pinless",position:4,icon:""},{categoryName:"longdistance",title:"Long Distance",url:"#/pos/category/longdistance/countries",position:3,icon:""},{categoryName:"wireless",title:"Wireless Recharge",url:"#/pos/category/wireless/carriers",position:6,icon:""},{categoryName:"sunpass",title:"SunPass",url:"#/sunpass",position:5,icon:""},{categoryName:"promotions",title:"Specials",url:"#/pos/category/promotions",position:8,icon:"star"},{categoryName:"directtv",title:"Direct TV",url:"#/directtv/categories",position:9,icon:""}];e.getMainProducts=function(t){e.items=[];var r=[];n.getPosMainProducts(i.MerchantId,i.MerchantPassword).then(function(n){r=n;for(var a=0;a<t.length;a++)r.indexOf(t[a].categoryName)>=0&&e.items.push(t[a])},function(){})},e.getMainProducts(c),e.addAlert=function(){r.add("success","Welcome!"+i.Name+"This is a success message!")},e.filterables=[{name:"Rate",value:"rate"},{name:"Country",value:"countryName"},{name:"Category",value:"category"}],e.selectProduct=function(e){a.set("selection",e)}}])}(),function(){"use strict";angular.module("posApp").controller("LoginCtrl",["$scope","AlertService","$location","AuthenticationFactory","localStorageService","$rootScope","SITE_URL","$modal",function(e,t,r,n,a,o,i,c){function s(e){if(200===e.Status){var r=e.UserInfo;a.set("userInfo",r),t.add("success","Welcome!")}else t.add("error","Invalid Credentials!")}e.isApplying=!1,e.toggleApplication=function(){e.isApplying=!e.isApplying},e.closeAlert=function(t){e.alerts.splice(t,1)},e.submitLogin=function(o){return e.submitted=!0,o.$invalid?(t.clear(),void t.add("error","Check errors below")):void(o.$valid&&(t.clear(),n.login(o.user.$modelValue,o.password.$modelValue).then(function(e){if(200===e.Status){var n=e.UserInfo;a.set("userInfo",n),r.path("/")}else t.add("error","Invalid Credentials!")},function(){t.add("error","Invalid Credentials")})))},e.loginDemo=function(){t.clear(),n.login(834,"M5494").then(function(e){s(e),location.href="google.com"},function(){t.add("error","Invalid Credentials")})},e.submitted=!1,e.applicantSubmit=function(r){if(e.submitted=!0,r.$invalid)return t.clear(),void t.add("error","Check errors below");if(r.$valid){t.clear();var a={Name:r.user.$modelValue,PhoneNumber:r.phone.$modelValue,Email:r.email.$modelValue,Address:r.address.$modelValue,State:r.state.$modelValue,ZipCode:r.zip.$modelValue};n.submitApplicant(a).then(function(e){200===e.Status&&(t.clear(),t.add("success","Application Successfully submited!"))},function(){t.add("error","Problems processing your application. Try again later, please.")})}},e.open=function(t){var r=c.open({templateUrl:"./app/login/_modal-demo-tpl.html",controller:"ModalFormInstanceCtrl",size:"sm",windowClass:"demo-modal",resolve:{item:function(){return t}}});r.result.then(function(t){e.selected=t},function(){})},e.demoAcccess=[{category:"international",categoryName:"International Top Up",caption:"Instantly load International wireless phones for over 200 Countries worldwide.",imageUrl:"Images/landing/01a-bkt-POS-landing.png"},{category:"wireless",categoryName:"Wireless",caption:"Load prepaid pay-as-you-go wireless accounts! Offer a wide variety of carriers.",imageUrl:"Images/landing/pinless.png"},{category:"longdistance",categoryName:"Long Distance",caption:"Load prepaid pay-as-you-go wireless accounts! Offer Variety of carriers.",imageUrl:"Images/landing/03a-bkt-POS-landing.png"},{category:"pinless",categoryName:"Pinless",caption:"A low-cost prepaid calling card program that does not require a PIN or scratch-off card.",imageUrl:"Images/landing/04a-bkt-POS-landing.png"}],e.states=[{name:"Alabama",abb:"AL"},{name:"Alaska",abb:"AK"},{name:"Arizona",abb:"AZ"},{name:"Arkansas",abb:"AR"},{name:"California",abb:"CA"},{name:"Colorado",abb:"CO"},{name:"Connecticut",abb:"CT"},{name:"Delaware",abb:"DE"},{name:"District Of Columbia",abb:"DC"},{name:"Florida",abb:"FL"},{name:"Georgia",abb:"GA"},{name:"Hawaii",abb:"HI"},{name:"Idaho",abb:"ID"},{name:"Illinois",abb:"IL"},{name:"Indiana",abb:"IN"},{name:"Iowa",abb:"IA"},{name:"Kansas",abb:"KS"},{name:"Kentucky",abb:"KY"},{name:"Louisiana",abb:"LA"},{name:"Maine",abb:"ME"},{name:"Maryland",abb:"MD"},{name:"Massachusetts",abb:"MA"},{name:"Michigan",abb:"MI"},{name:"Minnesota",abb:"MN"},{name:"Mississippi",abb:"MS"},{name:"Missouri",abb:"MO"},{name:"Montana",abb:"MT"},{name:"Nebraska",abb:"NE"},{name:"Nevada",abb:"NV"},{name:"New Hampshire",abb:"NH"},{name:"New Jersey",abb:"NJ"},{name:"New Mexico",abb:"NM"},{name:"New York",abb:"NY"},{name:"North Carolina",abb:"NC"},{name:"North Dakota",abb:"ND"},{name:"Ohio",abb:"OH"},{name:"Oklahoma",abb:"OK"},{name:"Oregon",abb:"OR"},{name:"Pennsylvania",abb:"PA"},{name:"Rhode Island",abb:"RI"},{name:"South Carolina",abb:"SC"},{name:"South Dakota",abb:"SD"},{name:"Tennessee",abb:"TN"},{name:"Texas",abb:"TX"},{name:"Utah",abb:"UT"},{name:"Vermont",abb:"VT"},{name:"Virginia",abb:"VA"},{name:"Washington",abb:"WA"},{name:"West Virginia",abb:"WV"},{name:"Wisconsin",abb:"WI"},{name:"Wyoming",abb:"WY"}]}]).controller("ModalFormInstanceCtrl",["$scope","$location","$modalInstance","item","SITE_URL","AuthenticationFactory","AlertService","localStorageService",function(e,t,r,n,a,o,i,c){var s=n;e.modalOptions={closeButtonText:"Close",actionButtonText:"Submit",headerText:r.headerText},e.close=function(){r.close()},e.guestSubmit=function(e){if(e.$invalid)return i.clear(),void i.add("error","Check errors below");if(e.$valid){var t={Name:e.user.$modelValue,Email:e.email.$modelValue,MerchantId:834,MerchantPassword:"M5494"};o.submitGuest(t).then(function(e){200===e.Status&&(i.clear(),i.add("success","Application Successfully submited!"))},function(){}),o.login(834,"M5494").then(function(e){if(200===e.Status){var t=e.UserInfo;c.set("userInfo",t),r.close();var n=a+"#/pos/category/"+s;window.location=n}},function(){i.add("error","Invalid Credentials")})}}}])}(),function(){"use strict";angular.module("loginServices",[]).factory("AuthenticationFactory",["$http","$rootScope","API_URL","$q","localStorageService",function(e,t,r,n,a){var o,i,c={tracker:t.loadingTracker};return{login:function(t,a){var s=n.defer();return e.post(r+"Merchant/GetMerchantDetails",{MerchantId:t,MerchantPassword:a},c).then(function(e){null!=e.data.Data&&(i={Name:e.data.Data.Name,MerchantId:e.data.Data.MerchantId,MerchantPassword:e.data.Data.MerchantPassword,ProfileId:e.data.Data.MerchantProfileId,TerminalId:e.data.Data.MerchantTerminalId,Status:e.data.Data.Status,Id:e.data.Data.Id,TimeStamp:e.data.Data.TimeStamp,IsMerchant:e.data.Data.IsMerchant,BusinessName:e.data.Data.MerchantBusinessName,IsFullCarga:e.data.Data.IsFullCarga}),o={Status:e.data.Status,UserInfo:i},s.resolve(o)},function(e){s.reject(e)}),s.promise},isLoggedIn:function(){i=a.get("userInfo");var e=null!=i&&i.Status?i:!1;return e},getUserInfo:function(){return a.get("userInfo")&&(i=a.get("userInfo")),i},submitApplicant:function(t){var a=n.defer();return e.post(r+"guest/submitapplication",t).then(function(e){o=e.data,a.resolve(o)},function(e){a.reject(e)}),a.promise},submitGuest:function(t){var a=n.defer();return e.post(r+"guest/submitguest",t).then(function(e){o=e.data,a.resolve(o)},function(e){a.reject(e)}),a.promise}}}])}(),function(){"use strict";angular.module("posApp").controller("OthersCtrl",["$scope","AlertService",function(e,t){t.add("info","Nothing to do...")}])}(),function(){"use strict";angular.module("posApp").controller("IndexByCategoryByCarrierCtrl",["$scope","$routeParams","ProdsFactory","AlertService","localStorageService","$location",function(e,t,r,n,a,o){var i=t.carrier;e.useMostPopular=!0,e.isMostPopular=!1,e.useConfig=!0,e.useAcronymFilter=!0,e.showAcronymFilter=!0,e.viewsearch="carriers",e.selectdisplay="carrier",e.type=o.path().split("/").splice(1,1).toString(),e.category=t.category,e.mostpopular="category/"+e.category,e.getWirelessCarrierDetails=function(){r.getWirelessCarrierDetails(i).then(function(t){e.details=t},function(){})},e.getWirelessProductsByCarrier=function(){r.getWirelessProductsByCarrier(i).then(function(t){e.items=t},function(){})},e.getWirelessProductsByCarrier()}])}(),function(){"use strict";angular.module("posApp").controller("IndexByCategoryByCountryCtrl",["$scope","$routeParams","ProdsFactory","AlertService","localStorageService","SharedFunctions","$location",function(e,t,r,n,a,o,i){var c=t.category,s=t.country;e.useMostPopular=!0,e.isMostPopular=!1,e.useConfig=!0,e.useAcronymFilter=!0,e.showAcronymFilter=!0,e.selectdisplay="country",e.configDisplay="Country",e.configPath="category/"+c+"/countries",e.viewsearch="countries",e.type=i.path().split("/").splice(1,1).toString(),e.category=c,e.mostpopular="category/"+c,e.getCountryDetails=function(){r.getCountryDetails(c,s).then(function(t){e.details=t},function(){})},e.getProductInitialsByCategoryByCountry=function(){r.getProductInitialsByCategoryByCountry(c,s).then(function(t){e.alpha=t},function(){})},e.getProductsByCategoryByCountry=function(){r.getProductsByCategoryByCountry(c,s).then(function(t){e.items=t},function(){})},e.getProductsByCategoryByCountry()}])}(),function(){"use strict";angular.module("posApp").controller("IndexByCategoryCtrl",["$scope","$routeParams","ProdsFactory","AlertService","SharedFunctions","$location",function(e,t,r,n,a,o){e.useMostPopular=!0,e.isMostPopular=!0,e.showAcronym=!1,e.useAcronym=!0,e.useConfig="pinless"===t.category?!1:!0;var i=t.category,c="longdistance"===i||"international"===i?"countries":"carriers";e.configDisplay="longdistance"===i||"international"===i?"country":"carrier",e.configPath="category/"+i+"/"+c,e.type=o.path().split("/").splice(1,1).toString(),e.mostpopular="category/"+i,e.viewsearch="wireless"===i?"carriers":"countries",e.activeClass=function(t){return t===e.letter?" active":"cosa"},e.getProductInitialsByCategory=function(){r.getProductInitialsByCategory(i).then(function(t){e.alpha=t},function(){})},e.getAllProducts=function(){r.getAllProducts(i).then(function(t){e.items=t},function(){})},e.getProductInitialsByCategory(),e.getAllProducts()}])}(),function(){"use strict";angular.module("posApp").controller("IndexCountriesByCategoryCtrl",["$scope","$routeParams","ProdsFactory","AlertService","localStorageService","SharedFunctions","$location",function(e,t,r,n,a,o,i){var c=t.category;
e.useMostPopular=!0,e.isMostPopular=!1,e.useAcronym=!0,e.showAcronym=!0,e.useConfig=!1,e.type=i.path().split("/").splice(1,1).toString(),e.category=c,e.mostpopular="category/"+c,e.activeClass=function(t){return t===e.letter?" active":"cosa"},e.getCountryInitialsByCategory=function(){r.getCountryInitialsByCategory(c).then(function(t){e.alpha=t},function(){})},e.getCountriesByCategory=function(){r.getCountriesByCategory(c).then(function(t){e.items=t},function(){})},e.getCountryInitialsByCategory(),e.getCountriesByCategory()}])}(),function(){"use strict";angular.module("posApp").controller("IndexByCarriersCtrl",["$scope","$routeParams","ProdsFactory","AlertService","localStorageService","SharedFunctions","$location",function(e,t,r,n,a,o,i){e.letter="",e.useMostPopular=!0,e.isMostPopular=!1,e.useConfig=!1,e.useAcronym=!0,e.showAcronym=!0,e.viewsearch="carriers",e.selectdisplay="carrier",e.type=i.path().split("/").splice(1,1).toString();var c=t.category;e.mostpopular="category/"+c;var s="USA";e.activeClass=function(t){return t===e.letter?" active":"cosa"},e.getWirelessCarrierInitials=function(){r.getWirelessCarrierInitials(s).then(function(t){e.alpha=t},function(){})},e.getWirelessCarriers=function(){r.getWirelessCarriers(s).then(function(t){e.items=t},function(){})},e.getWirelessCarrierInitials(),e.getWirelessCarriers()}])}(),function(){"use strict";angular.module("prodsServices",[]).factory("ProdsFactory",["$http","$rootScope","API_URL","$q","SharedFunctions","localStorageService",function(e,t,r,n,a,o){var i,c,s,u,l={tracker:t.loadingTracker},d=o.get("userInfo");if(a.isobject(d))var m={MerchantId:d.MerchantId,MerchantPassword:d.MerchantPassword};return{getProductsByCategoryByCountry:function(t,a){var o={MerchantId:m.MerchantId,MerchantPassword:m.MerchantPassword,Category:t,CountryCode:a},i=n.defer();return e.post(r+"Products/GetProductsByCategoryByCountry",o,l).then(function(e){s=e.data.Data,i.resolve(s)},function(e){i.reject(e)}),i.promise},getProduct:function(t){var a={MerchantId:m.MerchantId,MerchantPassword:m.MerchantPassword,ProductMainCode:t},o=n.defer();return e.post(r+"Products/GetProduct",a,l).then(function(e){c=e.data.Data,o.resolve(c)},function(e){o.reject(e)}),o.promise},getProductTerms:function(t){var a={MerchantId:"834",MerchantPassword:"m5494",ProductMainCode:t},o=n.defer();return e.post(r+"Products/GetProduct",a,l).then(function(e){c=e.data.Data,o.resolve(c)},function(e){o.reject(e)}),o.promise},getProductRates:function(t){var a={MerchantId:m.MerchantId,MerchantPassword:m.MerchantPassword,ProductMainCode:t},o=n.defer();return e.post(r+"Products/GetProductRates",a,l).then(function(e){var t=e.data.Data;o.resolve(t)},function(e){o.reject(e)}),o.promise},getProductAccessNumbers:function(t){var a={MerchantId:m.MerchantId,MerchantPassword:m.MerchantPassword,ProductMainCode:t},o=n.defer();return e.post(r+"Products/GetProductAccessNumbers",a,l).then(function(e){var t=e.data.Data;o.resolve(t)},function(e){o.reject(e)}),o.promise},getAllProducts:function(t){var a={MerchantId:m.MerchantId,MerchantPassword:m.MerchantPassword,Category:t},o=n.defer();return e.post(r+"Products/GetAllProducts",a,l).then(function(e){s=e.data.Data,o.resolve(s)},function(e){o.reject(e)}),o.promise},getProductInitialsByCategory:function(t){var a={MerchantId:m.MerchantId,MerchantPassword:m.MerchantPassword,Category:t},o=n.defer();return e.post(r+"Products/GetProductInitialsByCategory",a,l).then(function(e){i=e.data.Data,o.resolve(i)},function(e){o.reject(e)}),o.promise},getProductInitialsByCategoryByCountry:function(t,a){var o={MerchantId:m.MerchantId,MerchantPassword:m.MerchantPassword,Category:t,CountryCode:a},c=n.defer();return e.post(r+"Products/GetProductInitialsByCategoryByCountry",o,l).then(function(e){i=e.data.Data,c.resolve(i)},function(e){c.reject(e)}),c.promise},getCarriers:function(t){var a={MerchantId:m.MerchantId,MerchantPassword:m.MerchantPassword,Category:t},o=n.defer();return e.post(r+"Products/GetCarriers",a,l).then(function(e){i=e.data.Data,o.resolve(i)},function(e){o.reject(e)}),o.promise},getCountriesByCategory:function(t){var a={MerchantId:m.MerchantId,MerchantPassword:m.MerchantPassword,Category:t},o=n.defer();return e.post(r+"Products/GetCountriesByCategory",a,l).then(function(e){i=e.data.Data,o.resolve(i)},function(e){o.reject(e)}),o.promise},getCountryInitialsByCategory:function(t){var a={MerchantId:m.MerchantId,MerchantPassword:m.MerchantPassword,Category:t},o=n.defer();return e.post(r+"Products/GetCountryInitialsByCategory",a).then(function(e){i=e.data.Data,o.resolve(i)},function(e){o.reject(e)}),o.promise},getRates:function(t){var a={MerchantId:m.MerchantId,MerchantPassword:m.MerchantPassword,ProductMainCode:t},o=n.defer();return e.post(r+"Products/GetProductRates",a,l).then(function(e){i=e.data,o.resolve(i)},function(e){o.reject(e)}),o.promise},getLongDistanceCountries:function(){var t={MerchantId:m.MerchantId,MerchantPassword:m.MerchantPassword},a=n.defer();return e.post(r+"Products/GetLongDistanceCountries",t,l).then(function(e){u=e.data.Data,a.resolve(u)},function(e){a.reject(e)}),a.promise},getLongDistanceProductsByCountry:function(t){var a={MerchantId:m.MerchantId,MerchantPassword:m.MerchantPassword,CountryName:t},o=n.defer();return e.post(r+"Products/GetLongDistanceProductsByCountry",a,l).then(function(e){i=e.data.Data,o.resolve(i)},function(e){o.reject(e)}),o.promise},getCountryDetails:function(t,a){var o={MerchantId:m.MerchantId,MerchantPassword:m.MerchantPassword,Category:t,CountryCode:a},c=n.defer();return e.post(r+"Products/GetCountryDetailsByCategory",o,l).then(function(e){i=e.data.Data,c.resolve(i)},function(e){c.reject(e)}),c.promise},getWirelessCarriers:function(t){var a={MerchantId:m.MerchantId,MerchantPassword:m.MerchantPassword,CountryCode:t},o=n.defer();return e.post(r+"Products/GetWirelessCarriers",a,l).then(function(e){i=e.data.Data,o.resolve(i)},function(e){o.resolve(e)}),o.promise},getWirelessProductsByCarrier:function(t){var a={MerchantId:m.MerchantId,MerchantPassword:m.MerchantPassword,CarrierId:t},o=n.defer();return e.post(r+"Products/GetWirelessProductsByCarrier",a,l).then(function(e){i=e.data.Data,o.resolve(i)},function(e){o.reject(e)}),o.promise},getWirelessCarrierDetails:function(t){var a={MerchantId:m.MerchantId,MerchantPassword:m.MerchantPassword,CarrierId:t},o=n.defer();return e.post(r+"Products/GetWirelessCarrierDetails",a,l).then(function(e){i=e.data.Data,o.resolve(i)},function(e){o.reject(e)}),o.promise},getWirelessCarrierInitials:function(t){var a={MerchantId:m.MerchantId,MerchantPassword:m.MerchantPassword,CountryCode:t},o=n.defer();return e.post(r+"products/GetWirelessCarrierInitials",a,l).then(function(e){i=e.data.Data,o.resolve(i)},function(e){o.reject(e)}),o.promise},doBlackstonePosOperation:function(t){var a=n.defer();return e.post(r+"Products/DoBlackstonePosOperation",t,l).then(function(e){var t=e.data;a.resolve(t)},function(e){a.reject(e)}),a.promise},getPosMainProducts:function(t,a){t={MerchantId:t,MerchantPassword:a};var o=n.defer();return e.post(r+"Products/GetPosMainProducts",t,l).then(function(e){var t=e.data.Data;o.resolve(t)},function(e){o.reject(e)}),o.promise}}}])}(),function(){"use strict";angular.module("posApp").controller("ModalInstanceCtrl",["$scope","$modalInstance","item",function(e,t,r){e.items=r,e.selected={item:e.items},e.modalOptions={closeButtonText:"Close",actionButtonText:"Save",headerText:t.headerText},e.close=function(){t.close(e.selected.items)},e.cancel=function(){t.dismiss("cancel")}}]).controller("ShowProductCtrl",["$scope","$routeParams","$modal","ProdsFactory","AlertService","localStorageService","SharedFunctions","ConfirmationFactory",function(e,t,r,n,a,o,i,c){function s(){e.phoneNumber.value||(e.phoneNumber.value=""),e.amount.value||(e.amount.value=""),e.phoneMatch.value||(e.phoneMatch.value="")}function u(t){var r=n.getProductRates(t).then(function(t){var r={Name:e.item.Name,CountryName:e.item.CountryName,CarrierName:e.item.CarrierName},n=i.merge(t,r);return n},function(){});return r}function l(t){var r=n.getProductAccessNumbers(t).then(function(t){var r={Name:e.item.Name,CountryName:e.item.CountryName,CarrierName:e.item.CarrierName},n=i.merge(t,r);return n},function(){});return r}function d(t){e.phoneMatch.value=e.phoneMatch.value+t}function m(t){e.phoneNumber.value=e.phoneNumber.value+t}function p(t){e.amount.value=e.amount.value+t}function h(t){e.amount.isFocused?p(t):e.phoneNumber.isFocused?m(t):d(t)}function f(){var t=e.phoneNumber.value.length,r=e.phoneNumber.value;e.phoneNumber.value=r.substring(0,t-1)}function g(){var t=e.phoneMatch.value.length,r=e.phoneMatch.value;e.phoneMatch.value=r.substring(0,t-1)}function v(){var t=e.amount.value.length,r=e.amount.value;e.amount.value=r.substring(0,t-1)}var y=t.id,b=o.get("userInfo");e.settings=o.get("settings"),e.showReceipt=!1,e.isMobile=i.isMobile(),e.oneAtATime=!0,e.status={isFirstOpen:!i.isMobile(),isFirstDisabled:!1},e.getProduct=function(){n.getProduct(y).then(function(t){e.item=t,e.phoneNumber.value=e.phoneMatch.value=t.DialCountryCode,e.hasKeyPad=!t.UseFixedDenominations||t.IsTopUp},function(){})},e.getProduct(),e.phoneNumber={value:null,isFocused:!1},e.phoneMatch={value:null,isFocused:!1},e.amount={value:null,isFocused:!1},e.open=function(t){var n={firstItem:e.item.Name,secondItem:e.item.CountryName,thirdItem:e.item.CarrierName};t=i.merge(t,n);var a=r.open({templateUrl:"./app/products/_modal-product-tpl.html",controller:"ModalInstanceCtrl",size:"lg",windowClass:"product-modal",resolve:{item:function(){return t}}});a.result.then(function(t){e.selected=t},function(){})},e.openRates=function(t){var n=u(t),a=r.open({templateUrl:"./app/products/_modal-product-tpl.html",controller:"ModalInstanceCtrl",size:"lg",windowClass:"product-modal",resolve:{item:function(){return n}}});a.result.then(function(t){e.selected=t},function(){})},e.openAccessNumbers=function(t){for(var n=l(t),a=0;a<n.length;a++)delete n.languageField;var o=r.open({templateUrl:"./app/products/_modal-product-tpl.html",controller:"ModalInstanceCtrl",size:"lg",windowClass:"product-modal",resolve:{item:function(){return n}}});o.result.then(function(t){e.selected=t},function(){})},e.editing=null,e.editItem=function(t){e.editing=t},e.onInputClick=function(e){e.target.select()},e.setKey=function(e){s(),h(e)},e.clearKey=function(){e.phoneNumber.isFocused?e.phoneNumber.value="":e.amount.value=""},e.backKey=function(){s(),e.phoneNumber.isFocused?f():e.amount.isFocused?v():g()},e.setFocusedInput=function(t){"amount"===t?(e.phoneNumber.isFocused=!1,e.phoneMatch.isFocused=!1,e.amount.isFocused=!0):"phoneNumber"===t?(e.amount.isFocused=!1,e.phoneMatch.isFocused=!1,e.phoneNumber.isFocused=!0):"phoneMatch"===t&&(e.amount.isFocused=!1,e.phoneNumber.isFocused=!1,e.phoneMatch.isFocused=!0)},e.leaveInputsFocus=function(){e.amount.isFocused=!1,e.phoneNumber.isFocused=!1,e.phoneMatch.isFocused=!1},e.setAmount=function(t){e.amount=e.amount===t?void 0:t},e.submit=function(t){if(e.submitted=!0,t.$invalid)return void a.clear();e.isBlocked=!0,a.clear();var r={MerchantId:b.MerchantId,MerchantPassword:b.MerchantPassword,OperatorName:b.userName,ProfileId:b.profileId,TerminalId:b.terminalId,Amount:e.amount.value,PhoneNumber:e.phoneNumber.value,ProductMainCode:e.item.Code,CountryCode:e.item.DialCountryCode};n.doBlackstonePosOperation(r).then(function(t){if(200===t.Status||203===t.Status){var r=200===t.Status?"Order processed!":"Order placed. Pending for further Execution!";e.showReceipt=!0,e.submitted=!1,a.add("success",r),e.receipt=t.Data}else a.add("error",t.ErrorMessage),e.isBlocked=!1},function(){e.isBlocked=!1,a.add("error","Invalid Credentials")}),e.showReceipt=!1},e.printInfo=function(){window.print()},e.sendSms=function(t){if(e.submittedSms=!0,t.$invalid)return a.clear(),a.add("error","Check form errors"),!1;a.clear();var r=e.receipt,n=e.phoneToSend;c.sendConfirmationSms(r,n).then(function(t){a.clear(),e.submittedSms=!1,200===t.Status?a.add("success","The Receipt has been sent as sms successfully!"):a.add("error","Sorry, an error has happened. Please, try again.")},function(e){a.add("error",e.ErrorMessage)})},e.sendEmail=function(t){if(e.submittedEmail=!0,t.$invalid)return a.clear(),a.add("error","Check form errors"),!1;a.clear();var r=e.receipt,n=e.emailToSend;c.sendConfirmationEmail(r,n).then(function(t){a.clear(),e.submittedEmail=!1,200===t.Status?a.add("success","The Receipt has been sent as email successfully!"):a.add("error","Sorry, an error has happened. Please, try again.")},function(e){a.add("error",e.ErrorMessage)})}}])}(),function(){"use strict";angular.module("posApp").controller("ShowTermsCtrl",["$scope","$routeParams","ProdsFactory",function(e,t,r){var n=t.id;e.getProductTerms=function(){r.getProductTerms(n).then(function(t){e.item=t},function(){})},e.getProductTerms(),e.printInfo=function(){window.print()}}])}(),function(){"use strict";angular.module("posApp").controller("PromosCtrl",["$scope","$routeParams","PromosFactory","AlertService",function(e,t,r,n){e.getPromotions=function(){r.getPromotions().then(function(t){e.items=t},function(e){n.add("error",e)})},e.getPromotions()}])}(),function(){"use strict";angular.module("promosServices",[]).factory("PromosFactory",["$http","$rootScope","API_URL","$q","SharedFunctions","localStorageService",function(e,t,r,n,a,o){var i={tracker:t.loadingTracker},c=o.get("userInfo"),s={MerchantId:c.MerchantId,MerchantPassword:c.MerchantPassword},u=[];return{getPromotions:function(){var t=n.defer();return e.post(r+"Promotions/GetAllPromotions",s,i).then(function(e){u=e.data.Data,t.resolve(u)},function(e){t.reject(e)}),t.promise}}}])}(),function(){"use strict";angular.module("posApp").controller("ModalAccountCtrl",["$scope","$modalInstance","item","$location","localStorageService",function(e,t,r,n,a){e.merchant=r,e.openAdmin=function(){t.close(),n.path("/admin")},e.logout=function(){t.close(),a.clearAll()},e.close=function(){t.close()},e.cancel=function(){t.dismiss("cancel")}}]).controller("MainCtrl",["$rootScope","$scope","$location","localStorageService","AuthenticationFactory","MerchantFactory","AdminFactory","AlertService","$modal",function(e,t,r,n,a,o,i,c,s){var u={};u.userInfo=n.get("userInfo"),u.salesDetails=null,u.balanceDetails=null,t.closeAlert=function(e){t.alerts.splice(e,1)};var l=function(){var e={show:!0,title:"HOME",instruction:"Select category"};return e},d=function(){function e(e){switch(e){case"longdistance":i={show:!0,title:"Long Distance",instruction:"countries"===o?"Select Country":"Select Product"};break;case"international":i={show:!0,title:"International Top Up",instruction:"countries"===o?"Select Country":"Select Product"};break;case"pinless":i={show:!0,title:"Pinless",instruction:"Select Product"};break;case"wireless":i={show:!0,title:"Wireless",instruction:"carriers"===o?"Select Carrier":"Select Product"};break;case"promotions":i={show:!0,title:"Promotions",instruction:"Select Product"};break;default:i={show:"/login"===r.path()?!1:!0,title:t,instruction:"Select item"}}return i}var t=r.path().split("/").splice(1,1).toString(),n=r.path().split("/").splice(2,1).toString(),a=r.path().split("/").splice(3,1).toString(),o=r.path().split("/").splice(4,1).toString(),i={show:!0,title:t,instruction:"Select"+t.toUpperCase()};switch(t){case"pos":e(a);break;case"sunpass":i={show:!0,title:t,instruction:"Select "+t.toUpperCase()};break;case"billpayment":i={show:!0,title:"Bill Payment",instruction:"categories"===n?"Select Category":"category"===n?"Select Biller":"Complete the form"};break;case"others":i={show:!0,title:t,instruction:"Select item"};break;case"directtv":i={show:!0,title:"Direct Tv",instruction:"categories"===n?"Select Category":"category"===n?"Select Product":"Complete the form"};break;default:i={show:"/login"===r.path()?!1:!0,title:t,instruction:"Select item"}}return i},m=function(){return"/"===r.path()||"/login"===r.path()?!1:!0},p=function(){return"/login"===r.path()?!1:!0},h=function(){return"/login"===r.path()?!1:!0},f=function(){var e=n.get("userInfo");return e};t.viewInfo="/"===r.path()?l():d();var g=function(){var e=f();o.getSalesSummary(e.MerchantId,e.MerchantPassword).then(function(e){u.salesDetails=e},function(e){t.error=e})},v=function(){var e=f();o.getBalanceDetails(e.MerchantId,e.MerchantPassword).then(function(e){u.balanceDetails=e,t.spin=!1},function(e){t.error=e})};t.openAccountModal=function(){var e=s.open({templateUrl:"./app/admin/_modal-account-tpl.html",controller:"ModalAccountCtrl",size:"lg",windowClass:"product-modal",resolve:{item:function(){return g(),v(),u}}});e.result.then(function(e){t.selected=e},function(){})},t.showHome=m(),t.showAccount=p(),t.showNav=h();var y="http://mobile.blackstonepos.com/logos/pos-logo.png",b="http://mobile.blackstonepos.com/logos/fullCarga.png";u.userInfo&&u.userInfo.IsFullCarga?(t.logoUrl=b,t.isFullCarga=!0):(t.logoUrl=y,t.isFullCarga=!1),t.$watch(function(){return r.path()},function(e,r){e!==r&&(t.showHome=m(),t.showAccount=p(),t.showNav=h(),t.userInfo=n.get("userInfo"),t.isFullCarga=t.userInfo&&t.userInfo.IsFullCarga===!0?!0:!1,t.logoUrl=t.userInfo&&t.userInfo.IsFullCarga===!0?b:y,t.viewInfo="/"===e?l():d())},!0),t.$watch(a.isLoggedIn,function(e,t){!e&&t&&r.path("/login")},!0)}])}(),function(){"use strict";angular.module("posApp").directive("keypadNumeric",function(){return{restrict:"AE",replace:!0,templateUrl:"app/shared/_keypad-numeric.html",link:function(e,t){var r=t.find("a");r.on("click",function(){r.removeClass("active")})}}}).directive("topMenu",function(){return{restrict:"AE",replace:!0,templateUrl:"app/partials/top-menu.html",link:function(e,t){var r=t.find("a");r.on("click",function(){r.removeClass("active")})}}}).directive("productCaption",function(){return{restrict:"E",templateUrl:"app/directives/product-caption.html"}}).directive("salesDetails",function(){return{restrict:"A",templateUrl:"app/shared/_sales-details.html"}}).directive("workInProgress",function(){return{restrict:"A",templateUrl:"app/shared/_work-in-progress.html"}}).directive("countryFlag",function(){return{restrict:"E",replace:!0,template:'<span class="f24"> <span class="flag {{country.countryCode}}" data-cc="{{country.countryCode}}" data-country_name="{{country.countryCode}}"></span></span>'}}).directive("match",function(){return{require:"^ngModel",restrict:"A",scope:{match:"="},link:function(e,t,r,n){e.$watch(function(){return n.$pristine&&angular.isUndefined(n.$modelValue)||e.match===n.$modelValue},function(e){n.$setValidity("match",e)})}}}).directive("withkeypad",function(){return{require:"ngModel",restrict:"A",scope:{match:"="},link:function(e,t){var r;t.on("click",function(){r!==this&&(this.select(),r=this)}),t.on("blur",function(){r=null})}}}).directive("ngAlertConfirm",[function(){return{link:function(e,t,r){var n=r.ngConfirmClick||"Are you sure?",a=r.confirmedClick;t.bind("click",function(){window.confirm(n)&&e.$eval(a)})}}}]).directive("numberFormatValidator",function(){var e=[/\d+/,/^\S+$/];return{require:"ngModel",link:function(t,r,n,a){a.$validators.numberFormat=function(t){var r=!0;return angular.forEach(e,function(e){r=r&&e.test(t)}),r}}}}).directive("money",function(){function e(e,r,n,a){function o(e){var t=Math.pow(10,l);return Math.round(e*t)/t}function i(e){return parseFloat(e).toFixed(l)}function c(e){return a.$isEmpty(e)?"":""+e}var s,u=parseFloat(n.min||0),l=parseFloat(n.precision||2);a.$parsers.push(function(e){angular.isUndefined(e)&&(e=""),0===e.indexOf(".")&&(e="0"+e),0===e.indexOf("-")&&(u>=0?(e=null,a.$setViewValue(""),a.$render()):"-"===e&&(e=""));var r=a.$isEmpty(e);return r||t.test(e)?s=""===e?null:r?e:parseFloat(e):(a.$setViewValue(c(s)),a.$render()),a.$setValidity("number",!0),s}),a.$formatters.push(c);var d=function(e){return!a.$isEmpty(e)&&u>e?void a.$setValidity("min",!1):(a.$setValidity("min",!0),e)};a.$parsers.push(d),a.$formatters.push(d);var m="";n.$observe("max",function(e){m=parseFloat(e)});var p=function(e){return!a.$isEmpty(e)&&e>m?void a.$setValidity("max",!1):(a.$setValidity("max",!0),e)};a.$parsers.push(p),a.$formatters.push(p),l>-1&&(a.$parsers.push(function(e){return e?o(e):e}),a.$formatters.push(function(e){return e?i(e):e})),r.bind("blur",function(){var e=a.$modelValue;e&&(a.$viewValue=i(e),a.$render())})}var t=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/;return{restrict:"A",require:"ngModel",link:e}}).directive("emailValidator",function(){var e=[/^[a-zA-Z0-9._%-]+@[a-zA-Z0-9.-]+.[a-zA-Z]{2,4}$/,/^\S+$/];return{require:"ngModel",link:function(t,r,n,a){a.$validators.emailFormat=function(t){var r=!0;return angular.forEach(e,function(e){r=r&&e.test(t)}),r}}}}).directive("phoneValidator",function(){var e=[/^\([0-9]{3}\)[0-9]{3}-[0-9]{4}$/,/^[0-9]{10}$/];return{require:"ngModel",link:function(t,r,n,a){a.$validators.phoneFormat=function(t){var r=!0;return angular.forEach(e,function(e){r=r&&e.test(t)}),r}}}}).directive("phoneMatch",function(){return{restrict:"A",scope:!0,require:"ngModel",link:function(e,t,r,n){var a=function(){var t=e.$eval(r.ngModel),n=e.$eval(r.phoneMatch);return t===n};e.$watch(a,function(e){n.$setValidity("phonematch",e)})}}}).directive("accountMatch",function(){return{restrict:"A",scope:!0,require:"ngModel",link:function(e,t,r,n){var a=function(){var t=e.$eval(r.ngModel),n=e.$eval(r.accountMatch);return t===n};e.$watch(a,function(e){n.$setValidity("accountmatch",e)})}}}).directive("usaStates",function(){return{restrict:"E",templateUrl:'<select ng-options="state.abb as state.name for state in states"> <option value="">{{ emptyName }}</option> </select>',replace:!0,scope:!0,link:function(e,t,r){e.emptyName=r.emptyname||"Select State"},controller:["$scope",function(e){e.selectedState="",e.states=[{name:"Alabama",abb:"AL"},{name:"Alaska",abb:"AK"},{name:"Arizona",abb:"AZ"},{name:"Arkansas",abb:"AR"},{name:"California",abb:"CA"},{name:"Colorado",abb:"CO"},{name:"Connecticut",abb:"CT"},{name:"Delaware",abb:"DE"},{name:"District Of Columbia",abb:"DC"},{name:"Florida",abb:"FL"},{name:"Georgia",abb:"GA"},{name:"Hawaii",abb:"HI"},{name:"Idaho",abb:"ID"},{name:"Illinois",abb:"IL"},{name:"Indiana",abb:"IN"},{name:"Iowa",abb:"IA"},{name:"Kansas",abb:"KS"},{name:"Kentucky",abb:"KY"},{name:"Louisiana",abb:"LA"},{name:"Maine",abb:"ME"},{name:"Maryland",abb:"MD"},{name:"Massachusetts",abb:"MA"},{name:"Michigan",abb:"MI"},{name:"Minnesota",abb:"MN"},{name:"Mississippi",abb:"MS"},{name:"Missouri",abb:"MO"},{name:"Montana",abb:"MT"},{name:"Nebraska",abb:"NE"},{name:"Nevada",abb:"NV"},{name:"New Hampshire",abb:"NH"},{name:"New Jersey",abb:"NJ"},{name:"New Mexico",abb:"NM"},{name:"New York",abb:"NY"},{name:"North Carolina",abb:"NC"},{name:"North Dakota",abb:"ND"},{name:"Ohio",abb:"OH"},{name:"Oklahoma",abb:"OK"},{name:"Oregon",abb:"OR"},{name:"Pennsylvania",abb:"PA"},{name:"Rhode Island",abb:"RI"},{name:"South Carolina",abb:"SC"},{name:"South Dakota",abb:"SD"},{name:"Tennessee",abb:"TN"},{name:"Texas",abb:"TX"},{name:"Utah",abb:"UT"},{name:"Vermont",abb:"VT"},{name:"Virginia",abb:"VA"},{name:"Washington",abb:"WA"},{name:"West Virginia",abb:"WV"},{name:"Wisconsin",abb:"WI"},{name:"Wyoming",abb:"WY"}]}]}}).directive("innerNavFilters",function(){return{restrict:"AE",replace:!0,templateUrl:"app/shared/_inner-nav.html",link:function(e){var t={show:"Show Filter",hide:"Hide Filter"};e.acronymText=e.showAcronym===!0?t.hide:t.show,e.clearDisabled=!0,e.showFilter=function(){e.showAcronym=!e.showAcronym,e.acronymText=e.showAcronym===!0?t.hide:t.show},e.clearFilter=function(){e.letter="",e.acronymDisabled=!1,e.clearDisabled=!0},e.setFilter=function(t){e.letter=t,e.clearDisabled=!1}}}})}(),function(){"use strict";angular.module("appFilters",[]).filter("capitalize",function(){return function(e){return e?e.replace(/([^\W_]+[^\s-]*) */g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}):""}}).filter("makeSlug",function(){return function(e){return e=e||"",e.replace(/\s+/g,"-").toLowerCase()}}).filter("tel",function(){return function(e){if(!e)return"";var t=e.toString().trim().replace(/^\+/,"");if(t.match(/[^0-9]/))return e;var r,n,a;switch(t.length){case 10:r=1,n=t.slice(0,3),a=t.slice(3);break;case 11:r=t[0],n=t.slice(1,4),a=t.slice(4);break;case 12:r=t.slice(0,3),n=t.slice(3,5),a=t.slice(5);break;default:return e}return 1===r&&(r=""),a=a.slice(0,3)+"-"+a.slice(3),(r+" ("+n+") "+a).trim()}}).filter("ordinal",function(){return function(e){return e.charAt(0).toUpperCase()+e.substr(1).replace(/[A-Z]/g," $&")}}).filter("humanizeConstant",function(){return function(e){if(e){var t=e.split("_").join(" ").toLowerCase();return t=t.charAt(0).toUpperCase()+t.slice(1)}}}).filter("untilComa",function(){return function(e){if(!e||!e.length)return!1;var t,r=e.indexOf(",");return t=-1===r?e:e.substring(0,r)}}).filter("firstLetter",function(){return function(e,t){if(!e||!e.length)return!1;for(var r=[],n=new RegExp(t,"i"),a=0;a<e.length;a++){var o=e[a];n.test(o.Name.substring(0,1))&&r.push(o)}return r}}).filter("customCurrency",["$filter",function(e){return function(t,r){var n=e("currency");return 0>t?n(t,r).replace("(","-").replace(")",""):n(t,r)}}])}(),function(){"use strict";angular.module("customFunctions",[]).factory("SharedFunctions",[function(){return{unique:function(e){var t,r={},n=[];for(t=0;t<e.length;t++)r[e[t]]=e[t];for(t in r)n.push(r[t]);return n},serialize:function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t.join("&")},isobject:function(e){return!!e&&e.constructor===Object},alpha:function(){return["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"]},merge:function(e,t){for(var r in t)try{e[r]=t[r].constructor===Object?merge(e[r],t[r]):t[r]}catch(n){e[r]=t[r]}return e},firstleter:function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].Name.charAt(0));return t},isMobile:function(){return navigator.userAgent.match(/Android|BlackBerry|iPhone|iPad|iPod|Opera Mini|IEMobile/i)?!0:!1}}}])}(),function(){"use strict";angular.module("sharedServices",[]).factory("MerchantFactory",["$http","$rootScope","API_URL","$q",function(e,t,r,n){var a,o={tracker:t.loadingMerchantTracker};return{getSalesSummary:function(t,i){var c=n.defer();return a={MerchantId:t,MerchantPassword:i},e.post(r+"Merchant/GetSalesSummary",a,o).then(function(e){if(200===e.data.Status)var t={todaySales:e.data.Data.TodaySales,dailyCreditLimit:e.data.Data.DailyCreditLimit,daylyBalance:e.data.Data.DaylyBalance,weeklyCreditLimit:e.data.Data.WeeklyCreditLimit,weeklyBalance:e.data.Data.WeeklyBalance};c.resolve(t)},function(e){c.reject(e)}),c.promise},getBalanceDetails:function(t,i){var c=n.defer();return a={MerchantId:t,MerchantPassword:i},e.post(r+"Merchant/GetBalanceDetails",a,o).then(function(e){if(200===e.data.Status)var t={current:e.data.Data.Current,nextAch:e.data.Data.NextAch,nextAchDate:e.data.Data.NextAchDate};c.resolve(t)},function(e){c.reject(e)}),c.promise}}}]).factory("AchPaymentFactory",["$http","$rootScope","API_URL","$q","localStorageService",function(e,t,r,n,a){var o,i=a.get("userInfo"),c={tracker:t.loadingAdminTracker};return null!=i&&(o={MerchantId:i.MerchantId,MerchantPassword:i.password}),{getSavedPayments:function(){var t=n.defer();return e.post(r+"admin/GetSavedAchPayment",o,c).then(function(e){var r=e.data.Data;t.resolve(r)},function(e){t.reject(e)}),t.promise}}}]).factory("CashierFactory",["$http","$rootScope","API_URL","$q","localStorageService",function(e,t,r,n,a){var o,i={tracker:t.loadingAdminTracker},c=a.get("userInfo");return null!=c&&(o={MerchantId:c.MerchantId,MerchantPassword:c.MerchantPassword}),{getCashiers:function(t,a){var o=n.defer();return e.post(r+"admin/getallcashiers",{MerchantId:t,MerchantPassword:a},i).then(function(e){var t=e.data.Data;o.resolve(t)},function(e){o.reject(e)}),o.promise},saveCashier:function(t,a,c){var s=n.defer();return e.post(r+"admin/addcashier",{MerchantId:t,MerchantPassword:o.MerchantPassword,Name:a,Password:c},i).then(function(e){var t=e.data;s.resolve(t)},function(e){s.reject(e)}),s.promise},deleteCashier:function(t){var a=n.defer();return e.post(r+"admin/deletecashier",{MerchantId:o.MerchantId,MerchantPassword:o.MerchantPassword,Id:t},i).then(function(e){var t=e.data;a.resolve(t)},function(e){a.reject(e)}),a.promise},editCashier:function(t,a,c,s){var u=n.defer();return e.post(r+"admin/updatecashier",{MerchantId:t,MerchantPassword:o.MerchantPassword,Id:a,Name:c,password:s},i).then(function(e){var t=e.data;u.resolve(t)},function(e){u.reject(e)}),u.promise}}}]).factory("ExternalFactory",["$http","$rootScope","API_URL","$q","localStorageService","SharedFunctions",function(e,t,r,n,a,o){var i,c={tracker:t.loadingTracker},s=a.get("userInfo");return i=null!=s||o.isobject(s)?{MerchantId:s.MerchantId,MerchantPassword:s.MerchantPassword,PageNumber:null,PageSize:null}:{MerchantId:"834",MerchantPassword:"m5494"},{getActivationShopUrl:function(){var t=n.defer();return e.post(r+"admin/GetActivationExternalLogin",i,c).then(function(e){var r=e.data.Data;t.resolve(r)},function(e){t.reject(e)}),t.promise},getVonageUrl:function(){var t=n.defer();return e.post(r+"admin/GetVonageExternalLogin",i,c).then(function(e){var r=e.data.Data;t.resolve(r)},function(e){t.reject(e)}),t.promise}}}]).factory("SettingsFactory",["$http","$rootScope","API_URL","$q","localStorageService","SharedFunctions",function(e,t,r,n,a,o){var i,c={tracker:t.loadingAdminTracker},s=a.get("userInfo");return i=null!=s||o.isobject(s)?{MerchantId:s.MerchantId,MerchantPassword:s.MerchantPassword,PageNumber:null,PageSize:null}:{MerchantId:"834",MerchantPassword:"m5494"},{getSettings:function(){var t=n.defer();return e.post(r+"admin/getSettings",i,c).then(function(e){var r=e.data.Data;t.resolve(r)},function(e){t.reject(e)}),t.promise},updateSettings:function(t,a,o,s,u){var l=n.defer();return e.post(r+"admin/updateSettings",{MerchantId:t,MerchantPassword:i.MerchantPassword,SmallReceipt:a,Tax:o,ConfirmPhone:s,PaxTerminalAsPrinter:u},c).then(function(e){var t=e.data;l.resolve(t)},function(e){l.reject(e)}),l.promise}}}]).factory("OrderFactory",["$http","$rootScope","API_URL","$q","localStorageService","SharedFunctions",function(e,t,r,n,a,o){var i,c={tracker:t.loadingAdminTracker},s=a.get("userInfo");return i=null!=s||o.isobject(s)?{MerchantId:s.MerchantId,MerchantPassword:s.MerchantPassword,PageNumber:null,PageSize:null}:{MerchantId:"834",MerchantPassword:"m5494"},{getOrders:function(t,a){i.PageNumber=t,i.PageSize=a;var o=n.defer();return e.post(r+"admin/getallorders",i,c).then(function(e){var t=e.data;o.resolve(t)},function(e){o.reject(e)}),o.promise}}}]).factory("AdminFactory",["$http","$rootScope","API_URL","$q","localStorageService","SharedFunctions",function(e,t,r,n,a,o){var i,c={tracker:t.loadingAdminTracker},s=a.get("userInfo");return i=null!=s||o.isobject(s)?{MerchantId:s.MerchantId,MerchantPassword:s.MerchantPassword}:{MerchantId:"834",MerchantPassword:"m5494"},{getSavedAchPayments:function(){var t=n.defer(),a=r+"Admin/GetSavedAchPayments";return e.post(a,i,c).then(function(e){var r=e.data.Data;t.resolve(r)},function(e){t.reject(e)}),t.promise},addAchFunds:function(t,a,o,s,u,l,d){var m=n.defer();return e.post(r+"Admin/AddAchFunds",{Id:t,AccountNumber:a,RoutingNumber:o,MerchantId:s,MerchantPassword:i.MerchantPassword,Amount:u,SaveAccount:l,TypeChecking:d},c).then(function(e){var t=e.data;m.resolve(t)},function(e){m.reject(e)}),m.promise},getAppMainLogoUrl:function(t,a){var o=n.defer();return e.post(r+"admin/GetAppMainLogoUrl",{MerchantId:t,MerchantPassword:a},c).then(function(e){var t=e.data;o.resolve(t)},function(e){o.reject(e)}),o.promise}}}]).factory("ItemFactory",[function(){var e=[];return{selectObject:function(t){e=t},returnObject:function(){return e}}}]).factory("ConfirmationFactory",["$http","$rootScope","API_URL","$q","localStorageService",function(e,t,r,n,a){var o=[],i=a.get("userInfo"),c={MerchantId:i.MerchantId,MerchantPassword:i.MerchantPassword},s={tracker:t.loadingTracker};return{sendConfirmationSms:function(t,a){var i={PhoneNumber:a,Receipt:{ProductName:t.ProductName,ProductCountry:t.ProductCountry,CarrierName:t.CarrierName,ProductInstructions:t.ProductInstructions,PhoneNumber:t.PhoneNumber,PinNumber:t.PinNumber,ControlNumber:t.ControlNumber,OrderNumber:t.OrderNumber,TransactionId:t.TransactionId,UpdatedBalance:t.UpdatedBalance,MerchantName:t.MerchantName,MerchantPhoneNumber:t.MerchantPhoneNumber,CashierName:t.CashierName,MerchantAddress:t.MerchantAddress,OrderDate:t.OrderDate,Amount:t.Amount,Fee:t.Fee,Tax:t.Tax,Total:t.Total},MerchantId:c.MerchantId,MerchantPassword:c.MerchantPassword},u=n.defer();
return e.post(r+"ReceiptServices/SendConfirmationSms",i,s).then(function(e){o=e.data,u.resolve(o)},function(e){u.reject(e)}),u.promise},sendConfirmationEmail:function(t,a){var i={Email:a,Receipt:{ProductName:t.ProductName,ProductCountry:t.ProductCountry,CarrierName:t.CarrierName,ProductInstructions:t.ProductInstructions,PhoneNumber:t.PhoneNumber,PinNumber:t.PinNumber,ControlNumber:t.ControlNumber,OrderNumber:t.OrderNumber,TransactionId:t.TransactionId,UpdatedBalance:t.UpdatedBalance,MerchantName:t.MerchantName,MerchantPhoneNumber:t.MerchantPhoneNumber,CashierName:t.CashierName,MerchantAddress:t.MerchantAddress,OrderDate:t.OrderDate,Amount:t.Amount,Fee:t.Fee,Tax:t.Tax,Total:t.Total},MerchantId:c.MerchantId,MerchantPassword:c.MerchantPassword},u=n.defer();return e.post(r+"ReceiptServices/SendConfirmationEmail",i,s).then(function(e){o=e.data,u.resolve(o)},function(e){u.reject(e)}),u.promise}}}]).factory("AlertService",["$rootScope",function(e){var t={};return e.alerts=[],t.add=function(r,n){e.alerts.push({type:r,msg:n,close:function(){t.closeAlert(this)}})},t.closeAlert=function(r){t.closeAlertIdx(e.alerts.indexOf(r))},t.closeAlertIdx=function(t){e.alerts.splice(t,1)},t.clear=function(){e.alerts=[]},t.getAlertInstance=function(e){var t=e.Status,r=e.ErrorMessage,n={type:200===t?"success":"error",msg:""===r?"The Operation was completed successfuly":r};return n},t}])}(),function(){"use strict";angular.module("posApp").controller("IndexSunpassCtrl",["$scope",function(e){e.items=[{categoryName:"sunpass",title:"Activate or Replenish Sunpass",url:"#/sunpass/category/replenish",position:0,icon:""},{categoryName:"sunpass",title:"Pay Your Document",url:"#/sunpass/category/documents",position:1,icon:""}]}]).controller("ReplenishSunpassCtrl",["$scope","$routeParams","SunpassFactory","AlertService","SharedFunctions","ConfirmationFactory",function(e,t,r,n,a,o){function i(){var t=e.accountNumber.value.length,r=e.accountNumber.value;e.accountNumber.value=r.substring(0,t-1)}function c(){var t=e.accountMatch.value.length,r=e.accountMatch.value;e.accountMatch.value=r.substring(0,t-1)}function s(){var t=e.amount.value.length,r=e.amount.value;e.amount.value=r.substring(0,t-1)}function u(t){e.accountNumber.value=e.accountNumber.value+t}function l(t){e.accountMatch.value=e.accountMatch.value+t}function d(t){e.amount.value=e.amount.value+t}function m(){e.accountNumber.value||(e.accountNumber.value=""),e.accountMatch.value||(e.accountMatch.value=""),e.amount.value||(e.amount.value="")}function p(t){e.amount.isFocused?d(t):e.accountNumber.isFocused?u(t):l(t)}e.item={name:"Activate or Replenish Sunpass Transponder",MaxAmount:100},e.hasKeyPad=!0,e.showKeypad=!0,e.showPaymentDetails=!1,e.showDoReplenishment=!1,e.showReceipt=!1,e.showToCategories=!1,e.showToReplenish=!1,e.accountNumber={value:null,isFocused:!1},e.accountMatch={value:null,isFocused:!1},e.amount={value:null,isFocused:!1},e.submitted=!1,e.editing=null,e.editItem=function(t){e.editing=t},e.onInputClick=function(e){e.target.select()},e.setKey=function(e){m(),p(e)},e.clearKey=function(){e.accountNumber.isFocused?e.accountNumber.value="":e.amount.value=""},e.backKey=function(){m(),e.accountNumber.isFocused?i():e.amount.isFocused?s():c()},e.setFocusedInput=function(t){"amount"===t?(e.accountNumber.isFocused=!1,e.accountMatch.isFocused=!1,e.amount.isFocused=!0):"accountNumber"===t?(e.accountMatch.isFocused=!1,e.accountNumber.isFocused=!0,e.amount.isFocused=!1):"accountMatch"===t&&(e.accountNumber.isFocused=!1,e.accountMatch.isFocused=!0,e.amount.isFocused=!1)},e.leaveInputsFocus=function(){e.accountNumber.isFocused=!1,e.accountMatch.isFocused=!1,e.amount.isFocused=!1},e.doGetInfo=function(t){if(e.submitted=!0,t.$invalid)return n.clear(),void n.add("error","Check errors below (in red color)");var a=e.accountNumber.value;r.getSunpassTransporderInfo(a).then(function(t){200===t.Status?(e.isDisableInputs=!0,e.aditionalDataRequired=t.Data,e.showPaymentDetails=!0,e.showDoReplenishment=!0,e.submitted=!1):(n.clear(),n.add("error",t.ErrorMessage),e.isDisableInputs=!1)},function(){})},e.doReplenishment=function(t){if(e.submitted=!0,t.$invalid)return n.clear(),void n.add("error","Check errors below (in red color)");var a={TransporderNumber:e.accountNumber.value,PurchaseId:e.aditionalDataRequired.purchaseIdField,Amount:e.amount.value};r.doSunpassReplenishment(a).then(function(t){200===t.Status||203===t.Status?(e.isDisableInputs=!0,e.receipt=t.Data,e.showPaymentDetails=!0,e.showDoReplenishment=!1,e.showReceipt=!0,e.showToCategories=!0,e.showToReplenish=!0):(n.clear(),n.add("error",t.ErrorMessage),e.isDisableInputs=!1)},function(){})},e.printInfo=function(){window.print()},e.sendSms=function(t){if(e.submittedSms=!0,t.$invalid)return n.clear(),void n.add("error","Check form errors");n.clear();var r=e.receipt,a=e.phoneToSend;o.sendConfirmationSms(r,a).then(function(t){n.clear(),e.submittedSms=!1,200===t.Status?n.add("success","The Receipt has been sent as sms successfully!"):n.add("error","Sorry, an error has happened. Please, try again.")},function(e){n.add("error",e.ErrorMessage)})},e.sendEmail=function(t){if(e.submittedEmail=!0,t.$invalid)return n.clear(),void n.add("error","Check form errors");n.clear();var r=e.receipt,a=e.emailToSend;o.sendConfirmationEmail(r,a).then(function(t){n.clear(),e.submittedEmail=!1,200===t.Status?n.add("success","The Receipt has been sent as email successfully!"):n.add("error","Sorry, an error has happened. Please, try again.")},function(e){n.add("error",e.ErrorMessage)})}}]).controller("DocumentsSunpassCtrl",["$scope","$routeParams","SunpassFactory","AlertService","localStorageService","SharedFunctions","ConfirmationFactory",function(e,t,r,n,a,o,i){e.item={name:"Pay Your Documents"},e.showCheck=!0,e.showPaymentDetails=!1,e.showFieldsDescription=!0,e.showDoDocumentsPayment=!1,e.showReceipt=!1,e.submittedCheck=!1,e.submittedDoPayment=!1,e.idnumber=null,e.plate=null,e.total=0,e.fee=0,e.selectedDocuments=[],e.submitted=!1,e.parseFloat=function(e){return parseFloat(e)},e.setDocument=function(t,r){e.selectedDocuments=t,e.active=!e.active;var n=0;angular.forEach(t,function(e){n+=parseFloat(e.documentPaymentAmountField)}),e.total=n+parseFloat(e.fee),e.paymentType=r},e.doGetInfo=function(t){if(e.submittedCheck=!0,t.$invalid)return n.clear(),void n.add("error","Check errors below (in red color)");var a={DocumentId:e.idnumber,LicensePlate:e.plate};r.getSunpassDocumentsInfo(a).then(function(t){200===t.Status?(e.documents=t.Data,e.fee=t.Data.fee,e.isDisableInputs=!0,e.showCheck=!1,e.showFieldsDescription=!1,e.showPaymentDetails=!0,e.showDoDocumentsPayment=!0):(n.clear(),n.add("error",t.ErrorMessage),e.isDisableInputs=!1,e.showCheck=!0)},function(){})},e.doDocumentsPayment=function(t){if(e.submittedDoPayment=!0,t.$invalid)return n.clear(),void n.add("error","Check errors below (in red color)");var a={DocumentId:e.idnumber,LicencePlate:e.plate,PaymentType:e.paymentType};r.doSunPassDocumentsPayment(a).then(function(t){200===t.Status||203===t.Status?(e.showReceipt=!0,e.receipt=t.Data):(n.clear(),n.add("error",t.ErrorMessage),e.isDisableInputs=!1)},function(){})},e.printInfo=function(){window.print()},e.sendSms=function(t){if(e.submittedSms=!0,t.$invalid)return n.clear(),void n.add("error","Check form errors");n.clear();var r=e.receipt,a=e.phoneToSend;i.sendConfirmationSms(r,a).then(function(t){n.clear(),e.submittedSms=!1,200===t.Status?n.add("success","The Receipt has been sent as sms successfully!"):n.add("error","Sorry, an error has happened. Please, try again.")},function(e){n.add("error",e.ErrorMessage)})},e.sendEmail=function(t){if(e.submittedEmail=!0,t.$invalid)return n.clear(),void n.add("error","Check form errors");n.clear();var r=e.receipt,a=e.emailToSend;i.sendConfirmationEmail(r,a).then(function(t){n.clear(),e.submittedEmail=!1,200===t.Status?n.add("success","The Receipt has been sent as email successfully!"):n.add("error","Sorry, an error has happened. Please, try again.")},function(e){n.add("error",e.ErrorMessage)})}}])}(),function(){"use strict";angular.module("sunpassServices",[]).factory("SunpassFactory",["$http","$rootScope","API_URL","$q","SharedFunctions","localStorageService",function(e,t,r,n,a,o){var i=[],c=o.get("userInfo"),s={MerchantId:c.MerchantId,MerchantPassword:c.MerchantPassword},u={tracker:t.loadingTracker};return{getSunpassTransporderInfo:function(t){var a={MerchantId:s.MerchantId,MerchantPassword:s.MerchantPassword,TransporderNumber:t},o=n.defer();return e.post(r+"SunPass/GetSunpassTransporderInfo",a,u).then(function(e){i=e.data,o.resolve(i)},function(e){o.reject(e)}),o.promise},doSunpassReplenishment:function(t){var a={MerchantId:s.MerchantId,MerchantPassword:s.MerchantPassword,TransporderNumber:t.TransporderNumber,PurchaseId:t.PurchaseId,Amount:t.Amount},o=n.defer();return e.post(r+"SunPass/DoSunpassReplenishment",a,u).then(function(e){i=e.data,o.resolve(i)},function(e){o.reject(e)}),o.promise},getSunpassDocumentsInfo:function(t){var a={LicensePlate:t.LicensePlate,DocumentId:t.DocumentId,MerchantId:s.MerchantId,MerchantPassword:s.MerchantPassword},o=n.defer();return e.post(r+"SunPass/GetSunpassDocumentsInfo",a,u).then(function(e){i=e.data,o.resolve(i)},function(e){o.reject(e)}),o.promise},doSunPassDocumentsPayment:function(t){var a={MerchantId:s.MerchantId,MerchantPassword:s.MerchantPassword,PaymentType:t.PaymentType,DocumentId:t.DocumentId,LicensePlate:t.LicencePlate},o=n.defer();return e.post(r+"SunPass/DoSunPassDocumentsPayment",a,u).then(function(e){i=e.data,o.resolve(i)},function(e){o.reject(e)}),o.promise}}}])}();