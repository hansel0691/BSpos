(function(){"use strict";var n=angular.module("posApp",["ngRoute","ngAnimate","ngResource","ui.bootstrap","loginServices","adminServices","sharedServices","prodsServices","LocalStorageModule","appFilters","customFunctions","promosServices","billPaymentServices","sunpassServices","directTvServices","ajoslin.promise-tracker","datePicker","flash"]);n.constant("API_URL","http://bsapi.pinserve.com/api/");n.constant("SITE_URL","http://mobile.blackstonepos.com/");n.config(["$routeProvider",function(n){n.when("/login",{controller:"LoginCtrl",templateUrl:"./app/login/_login.html"}).when("/",{controller:"HomeCtrl",templateUrl:"app/home/_home.html"}).when("/admin",{controller:"AdminCtrl",templateUrl:"./app/admin/_admin.html"}).when("/pos/category/promotions",{controller:"PromosCtrl",templateUrl:"app/promotions/_index-promos.html"}).when("/pos/category/:category",{controller:"IndexByCategoryCtrl",templateUrl:"app/products/_index-products.html"}).when("/pos/category/:category/amount/:amount",{controller:"IndexByCategoryCtrl",templateUrl:"app/products/_index-products.html"}).when("/pos/category/:category/countries",{controller:"IndexCountriesByCategoryCtrl",templateUrl:"app/products/_index-countries.html"}).when("/pos/category/:category/country/:country",{controller:"IndexByCategoryByCountryCtrl",templateUrl:"app/products/_index-products.html"}).when("/pos/category/:category/carriers",{controller:"IndexByCarriersCtrl",templateUrl:"app/products/_index-carriers.html"}).when("/pos/category/:category/carrier/:carrier",{controller:"IndexByCategoryByCarrierCtrl",templateUrl:"app/products/_index-products.html"}).when("/pos/category/:category/product/:id",{controller:"ShowProductCtrl",templateUrl:"app/products/_show-product.html"}).when("/billpayment/categories",{controller:"IndexCategoriesBillPaymentCtrl",templateUrl:"app/billpayment/_index-categories.html"}).when("/billpayment/category/:category",{controller:"IndexByCategoryBillPaymentCtrl",templateUrl:"app/billpayment/_index-billers.html"}).when("/billpayment/popular",{controller:"IndexByPopularBillPaymentCtrl",templateUrl:"app/billpayment/_index-categories.html"}).when("/billpayment/biller/:biller",{controller:"ShowBillPaymentCtrl",templateUrl:"app/billpayment/_show-biller.html"}).when("/sunpass/category/documents",{controller:"DocumentsSunpassCtrl",templateUrl:"app/sunpass/_documents-sunpass.html"}).when("/sunpass/category/replenish",{controller:"ReplenishSunpassCtrl",templateUrl:"app/sunpass/_replenish-sunpass.html"}).when("/sunpass",{controller:"IndexSunpassCtrl",templateUrl:"app/sunpass/_index-sunpass.html"}).when("/directtv/categories",{controller:"IndexDirectTvCategoriesCtrl",templateUrl:"app/directtv/_index-categories-dtv.html"}).when("/directtv/category/:category",{controller:"IndexDirectTvByCategoryCtrl",templateUrl:"app/directtv/_index-dtv.html"}).when("/directtv/product/:product",{controller:"showDirectTvCtrl",templateUrl:"app/directtv/_show-dtv.html"}).when("/terms/:id",{controller:"ShowTermsCtrl",templateUrl:"app/products/_show-terms.html"}).when("/others",{controller:"directTvCtrl",templateUrl:"app/directtv/_index-directtv.html"}).otherwise({redirectTo:"/login"})}]);n.run(["$rootScope","$location","AuthenticationFactory",function(n,t,i){n.$on("$routeChangeSuccess",function(){i.isLoggedIn()?void 0:(console.log("OUT!"),void 0,t.path("/login"))})}]);n.run(["$rootScope","$location",function(n,t){var i=[];n.$on("$routeChangeSuccess",function(){i.push(t.$$path)});n.back=function(){var n=i.length>1?i.splice(-2)[0]:"/";t.path(n)}}]);n.run(["$rootScope","promiseTracker",function(n,t){n.loadingTracker=t({activationDelay:100,minDuration:350});n.loadingMerchantTracker=t({activationDelay:100,minDuration:350});n.loadingAdminTracker=t({activationDelay:100,minDuration:350})}]);n.config(["localStorageServiceProvider",function(n){n.setPrefix("pos")}]);n.config(["$httpProvider",function(n){n.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=utf-8";n.defaults.transformRequest=[function(n){var t=function(n){var r="",f,i,o,h,s,u,e;for(f in n)if(i=n[f],i instanceof Array)for(e=0;e<i.length;++e)s=i[e],o=f+"["+e+"]",u={},u[o]=s,r+=t(u)+"&";else if(i instanceof Object)for(h in i)s=i[h],o=f+"["+h+"]",u={},u[o]=s,r+=t(u)+"&";else i!==undefined&&i!==null&&(r+=encodeURIComponent(f)+"="+encodeURIComponent(i)+"&");return r.length?r.substr(0,r.length-1):r};return angular.isObject(n)&&String(n)!=="[object File]"?t(n):n}]}])})(),function(){"use strict";angular.module("posApp").controller("AdminCtrl",["$rootScope","$scope","$location","localStorageService","AuthenticationFactory","ExternalFactory","AdminFactory","CashierFactory","OrderFactory","SettingsFactory","AchPaymentFactory","Flash","$modal","$filter","$document","$timeout",function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){function tt(n){n!=null&&(t.payment.Id=n.Id,t.payment.AccountNumber=n.AccountNumber,t.payment.RoutingNumber=n.RoutingNumber,t.payment.TypeChecking=n.TypeChecking,t.payment.SaveAccount=n.SaveAccount)}function it(n){t.editcashier.id=n.Id;t.editcashier.name=n.Name;t.editcashier.password=n.Password}var w,d,g,b;l.dismiss();w=r.get("userInfo");t.filename="";t.initDates=function(){var n=new Date;t.start=n.setMonth(n.getMonth());t.end=new Date};t.initDates();t.todayDates=function(){var n=new Date;t.start=n.setDate(n.getDate()-1);t.end=new Date};t.tabs=[{title:"Cashiers",active:null},{title:"Settings",active:null},{title:"Orders",active:null}];b=parseInt(r.get("adminTab"));void 0;b&&b!=null?t.tabs[b].active=!0:t.tabs[0].active=!0;t.saveState=function(n){l.dismiss();r.set("adminTab",n)};d=w.MerchantId;g=w.MerchantPassword;var rt=function(){t.payment={Id:0,AccountNumber:null,RoutingNumber:null,TypeChecking:!0,SaveAccount:!1,MerchantId:w.MerchantId,Amount:0}},nt=function(){var n=w.IsMerchant;r.set("adminLogged",n);t.adminLogged=n},ut=function(){t.settings={SmallReceipt:null,Tax:null,ConfirmPhone:null,PaxTerminalAsPrinter:null}},k=function(){t.cashier={id:null,name:null,password:null};t.editcashier={id:null,name:null,password:null}};nt();rt();k();ut();nt();t.getSavedAchPayments=function(){e.getSavedAchPayments().then(function(n){t.achs=n;t.spin=!1;n!=null&&n.length>0&&tt(n[0])},function(){void 0})};t.addAchFunds=function(){e.addAchFunds(t.payment.Id,t.payment.AccountNumber,t.payment.RoutingNumber,t.payment.MerchantId,t.payment.Amount,t.payment.SaveAccount,t.payment.TypeChecking).then(function(n){l.create("success",n,"");t.getSavedAchPayments()},function(){void 0})};t.setSelectedCashier=function(){it(this.cashier);t.editMode=!0};t.getCashiers=function(){o.getCashiers(d,g).then(function(n){t.cashiers=n},function(){void 0})};t.deleteCashier=function(n){confirm("Are you sure you want to delete this cashier?")&&o.deleteCashier(w.MerchantId,w.MerchantPassword,n).then(function(n){l.create("success",n.ErrorMessage,"");t.getCashiers()},function(n){l.create("error",n.ErrorMessage,"");void 0})};t.saveCashier=function(){o.saveCashier(w.MerchantId,w.MerchantPassword,t.cashier.name,t.cashier.password).then(function(n){n.Status==200?l.create("success","Cashier Successfully Added!",""):l.create("error",n.ErrorMessage,"");k();t.getCashiers()},function(n){l.create("error",n.ErrorMessage,"");void 0})};t.updateCashier=function(){o.editCashier(w.MerchantId,w.MerchantPassword,t.editcashier.id,t.editcashier.name,t.editcashier.password).then(function(n){n.Status==200?l.create("success","Cashier Successfully Updated!",""):l.create("error",n.ErrorMessage,"");k();t.editMode=!1;t.getCashiers()},function(n){l.create("error",n.ErrorMessage,"");void 0})};t.cancelEditCashier=function(){t.editMode=!1};t.currentPage=1;t.perPage=10;t.noOfPages=15;t.totalItems=0;t.maxSize=5;t.getOrders=function(){var i=v("date")(t.start,"shortDate","-0500"),n;void 0;n=v("date")(t.end,"shortDate","-0500");void 0;s.getOrders(i,n,t.currentPage,t.perPage,w).then(function(n){t.orders=n.Data;t.totalItems=n.Count;t.spin=!1},function(n){l.create("error",n.ErrorMessage,"");void 0})};t.getAllOrdersSummary=function(){var n=v("date")(t.start,"shortDate","-0500"),i=v("date")(t.end,"shortDate","-0500");s.getAllOrdersSummary(n,i,w).then(function(n){t.sumary=n.Data},function(n){l.create("error",n.ErrorMessage,"");void 0})};t.pageChanged=function(n){t.currentPage=n;t.getOrders()};t.getSettings=function(){h.getSettings().then(function(n){var i=n;r.set("settings",i);t.settings=i},function(){void 0})};t.updateSettings=function(n){if(t.submitted=!0,n.$invalid){l.dismiss();l.create("error","Check errors below (in red color)","");return}n.$valid&&h.updateSettings(w.MerchantId,t.settings.SmallReceipt,t.settings.Tax,t.settings.ConfirmPhone,t.settings.PaxTerminalAsPrinter).then(function(n){n.Status===200?(t.updateSettingsResponse=n,r.set("settings",n.Data),l.create("success","Settings successfuly updated!",""),void 0):l.create("success",n.ErrorMessage,"")},function(n){l.create("error",n.ErrorMessage,"");void 0})};t.loginOverSesion=function(n){u.login(w.MerchantId,n).then(function(n){n.Status===200?(t.adminLogged=n.UserInfo.IsMerchant,void 0):l.create("error","Invalid Admin Credentials!","")},function(){l.create("error","Invalid Admin Credentials","");void 0})};t.submit=function(n){if(t.submitted=!0,n.$invalid){l.dismiss();return}n.$valid&&(l.dismiss(),e.addAchFunds(t.Id,t.AccountNumber,t.RoutingNumber,t.MerchantId,t.Amount,t.SaveAccount,t.TypeChecking).then(function(n){l.create("success",n,"")},function(n){l.create("error",n.ErrorMessage,"");void 0}))};t.updateOrders=function(){t.spin=!0;t.getOrders()};t.getSettings();t.getCashiers();t.getOrders();t.getAllOrdersSummary();t.today=function(){t.todayDates();t.getOrders();t.getAllOrdersSummary();void 0};t.clear=function(){t.initDates();t.getOrders();t.getAllOrdersSummary();void 0};t.getOrdersByDate=function(n){t.start=n.start.$modelValue;t.end=n.end.$modelValue;t.getOrders();t.getAllOrdersSummary()};t.refundOrder=function(n){void 0;s.refundOrder(n,w).then(function(i){i.Status===200?(l.create("success",i.ErrorMessage,""),angular.forEach(t.orders,function(t){t.Id===n&&(t.IsRefundable=!1)})):l.create("danger",i.ErrorMessage,"")},function(n){l.create("danger",n.ErrorMessage,"");void 0})};t.reSendOrderConfirmation=function(n){void 0;s.reSendOrderConfirmation(n,w).then(function(n){n.Status===200?l.create("success",n.ErrorMessage,""):l.create("danger",n.ErrorMessage,"")},function(n){l.create("danger",n.ErrorMessage,"");void 0})};t.downloadAsCvs=function(n){void 0;var i=v("date")(n.start.$modelValue,"MM/dd/yy","-0500"),r=v("date")(n.end.$modelValue,"MM/dd/yy","-0500");void 0;s.downloadAsCvs(i,r,w).then(function(n){var s=[],h="",e="",u="",c,o,f;angular.forEach(n.Data[0],function(n,t){s.push('"'+t+'"')});h=s.toString();angular.forEach(n.Data,function(n){var t=[];angular.forEach(n,function(n){t.push('"'+n+'"')});e=e.concat(t.toString());e=e.concat("\n")});u=u.concat(h);u=u.concat("\n");u=u.concat(e);t.doFilename=function(){return"orders-from-"+i.replace(/[^0-9\.]+/g,"")+"-to-"+r.replace(/[^0-9\.]+/g,"")+".csv"};c=t.charset||"utf-8";o=new Blob([u],{type:"text/csv;charset="+c+";"});window.navigator.msSaveOrOpenBlob?navigator.msSaveBlob(o,t.doFilename()):(f=angular.element("<a><\/a>"),f.attr("href",window.URL.createObjectURL(o)),f.attr("download",t.doFilename()),f.attr("target","_blank"),y.find("body").append(f),p(function(){f[0].click();f.remove()},null))},function(){void 0})};t.sendAsEmail=function(n){var t=v("date")(n.start.$modelValue,"MM/dd/yy","-0500"),i=v("date")(n.end.$modelValue,"MM/dd/yy","-0500"),r=n.email.$modelValue;s.sendAsEmail(t,i,r,w).then(function(n){void 0;n.Status===200&&l.create("success",n.ErrorMessage,"")},function(n){l.create("danger",n.ErrorMessage,"");void 0})}}])}(),function(){"use strict";angular.module("adminServices",[]).factory("MerchantFactory",["$http","$rootScope","API_URL","$q",function(n,t,i,r){var u,f={tracker:t.loadingMerchantTracker};return{getSalesSummary:function(t,e){var o=r.defer();return u={MerchantId:t,MerchantPassword:e},n.post(i+"Merchant/GetSalesSummary",u,f).then(function(n){if(n.data.Status===200)var t={todaySales:n.data.Data.TodaySales,dailyCreditLimit:n.data.Data.DailyCreditLimit,daylyBalance:n.data.Data.DaylyBalance,weeklyCreditLimit:n.data.Data.WeeklyCreditLimit,weeklyBalance:n.data.Data.WeeklyBalance};else void 0;o.resolve(t)},function(n){o.reject(n);void 0}),o.promise},getBalanceDetails:function(t,e){var o=r.defer();return u={MerchantId:t,MerchantPassword:e},n.post(i+"Merchant/GetBalanceDetails",u,f).then(function(n){if(n.data.Status===200)var t={current:n.data.Data.Current,nextAch:n.data.Data.NextAch,nextAchDate:n.data.Data.NextAchDate};else void 0;o.resolve(t)},function(n){o.reject(n);void 0}),o.promise}}}]).factory("AchPaymentFactory",["$http","$rootScope","API_URL","$q","localStorageService",function(n,t,i,r,u){var e,f=u.get("userInfo"),o={tracker:t.loadingAdminTracker};return f!=null&&(e={MerchantId:f.MerchantId,MerchantPassword:f.password}),{getSavedPayments:function(){var t=r.defer();return n.post(i+"admin/GetSavedAchPayment",e,o).then(function(n){var i=n.data.Data;t.resolve(i)},function(n){t.reject(n);void 0}),t.promise}}}]).factory("CashierFactory",["$http","$rootScope","API_URL","$q","localStorageService",function(n,t,i,r,u){var f={tracker:t.loadingAdminTracker},e=u.get("userInfo");return{getCashiers:function(t,u){var e=r.defer();return n.post(i+"admin/getallcashiers",{MerchantId:t,MerchantPassword:u},f).then(function(n){var t=n.data.Data;e.resolve(t)},function(n){e.reject(n);void 0}),e.promise},saveCashier:function(t,u,e,o){var s=r.defer();return n.post(i+"admin/addcashier",{MerchantId:t,MerchantPassword:u,Name:e,Password:o},f).then(function(n){var t=n.data;s.resolve(t)},function(n){s.reject(n);void 0}),s.promise},deleteCashier:function(t,u,e){var o=r.defer();return n.post(i+"admin/deletecashier",{MerchantId:t,MerchantPassword:u,Id:e},f).then(function(n){var t=n.data;void 0;o.resolve(t)},function(n){o.reject(n);void 0}),o.promise},editCashier:function(t,u,e,o,s){var h=r.defer();return n.post(i+"admin/updatecashier",{MerchantId:t,MerchantPassword:u,Id:e,Name:o,password:s},f).then(function(n){var t=n.data;h.resolve(t)},function(n){h.reject(n);void 0}),h.promise}}}]).factory("SettingsFactory",["$http","$rootScope","API_URL","$q","localStorageService","SharedFunctions",function(n,t,i,r,u,f){var o,s={tracker:t.loadingAdminTracker},e=u.get("userInfo");return o=e!=null||f.isobject(e)?{MerchantId:e.MerchantId,MerchantPassword:e.MerchantPassword,PageNumber:null,PageSize:null}:{MerchantId:"834",MerchantPassword:"m5494"},{getSettings:function(){var t=r.defer();return n.post(i+"admin/getSettings",o,s).then(function(n){var i=n.data.Data;t.resolve(i)},function(n){t.reject(n);void 0}),t.promise},updateSettings:function(t,u,f,e,h){var c=r.defer();return n.post(i+"admin/updateSettings",{MerchantId:t,MerchantPassword:o.MerchantPassword,SmallReceipt:u,Tax:f,ConfirmPhone:e,PaxTerminalAsPrinter:h},s).then(function(n){var t=n.data;c.resolve(t)},function(n){c.reject(n);void 0}),c.promise}}}]).factory("OrderFactory",["$http","$rootScope","API_URL","$q",function(n,t,i,r){var u={},f={tracker:t.loadingTracker};return{getOrders:function(t,e,o,s,h){u={StartDate:t,EndDate:e,PageNumber:o,PageSize:s,MerchantId:h.MerchantId,MerchantPassword:h.MerchantPassword};var c=r.defer();return n.post(i+"admin/getallorders",u,f).then(function(n){var t=n.data;c.resolve(t)},function(n){c.reject(n);void 0}),c.promise},getAllOrdersSummary:function(t,e,o){u={StartDate:t,EndDate:e,MerchantId:o.MerchantId,MerchantPassword:o.MerchantPassword};var s=r.defer();return n.post(i+"admin/GetAllOrdersSummary",u,f).then(function(n){var t=n.data;s.resolve(t)},function(n){s.reject(n);void 0}),s.promise},refundOrder:function(t,e){var o=r.defer();return u={MerchantId:e.MerchantId,MerchantPassword:e.MerchantPassword,OrderId:t},n.post(i+"admin/RefundOrder",u,f).then(function(n){var t=n.data;o.resolve(t)},function(n){o.reject(n);void 0}),o.promise},reSendOrderConfirmation:function(t,e){var o=r.defer();return u={MerchantId:e.MerchantId,MerchantPassword:e.MerchantPassword,OrderId:t},n.post(i+"admin/ReSendOrderConfirmation",u,f).then(function(n){var t=n.data;o.resolve(t)},function(n){o.reject(n);void 0}),o.promise},downloadAsCvs:function(t,e,o){u={StartDate:t,EndDate:e,MerchantId:o.MerchantId,MerchantPassword:o.MerchantPassword};var s=r.defer();return n.post(i+"admin/GetAllOrdersToExport",u,f).then(function(n){var t=n.data;s.resolve(t)},function(n){s.reject(n);void 0}),s.promise},sendAsEmail:function(t,e,o,s){var h=r.defer();return u={StartDate:t,EndDate:e,Email:o,MerchantId:s.MerchantId,MerchantPassword:s.MerchantPassword},n.post(i+"ReceiptServices/SendOrdersByEmail",u,f).then(function(n){var t=n.data;h.resolve(t)},function(n){h.reject(n);void 0}),h.promise}}}]).factory("AdminFactory",["$http","$rootScope","API_URL","$q","localStorageService","SharedFunctions",function(n,t,i,r,u,f){var o,s={tracker:t.loadingAdminTracker},e=u.get("userInfo");return o=e!=null||f.isobject(e)?{MerchantId:e.MerchantId,MerchantPassword:e.MerchantPassword}:{MerchantId:"834",MerchantPassword:"m5494"},{getSavedAchPayments:function(){var t=r.defer(),u=i+"Admin/GetSavedAchPayments";return n.post(u,o,s).then(function(n){var i=n.data.Data;t.resolve(i)},function(n){t.reject(n);void 0}),t.promise},addAchFunds:function(t,u,f,e,h,c,l){var a=r.defer();return n.post(i+"Admin/AddAchFunds",{Id:t,AccountNumber:u,RoutingNumber:f,MerchantId:e,MerchantPassword:o.MerchantPassword,Amount:h,SaveAccount:c,TypeChecking:l},s).then(function(n){var t=n.data;a.resolve(t)},function(n){void 0;a.reject(n)}),a.promise},getAppMainLogoUrl:function(t,u){var f=r.defer();return n.post(i+"admin/GetAppMainLogoUrl",{MerchantId:t,MerchantPassword:u},s).then(function(n){var t=n.data;void 0;f.resolve(t)},function(n){f.reject(n)}),f.promise}}}])}(),function(){"use strict";angular.module("posApp").controller("IndexByCategoryBillPaymentCtrl",["$scope","$routeParams","BillPaymentFactory","Flash","$location",function(n,t,i,r,u){r.dismiss();var f=t.category,e=f==="popular"?"":f;n.useMostPopular=!0;n.isMostPopular=f==="popular"?!0:!1;n.useAcronym=!0;n.showAcronym=!0;n.useConfig=!0;n.configPath="categories";n.configDisplay="Category";n.numLimit=25;n.type=u.path().split("/").splice(1,1).toString();n.mostpopular="category/popular";n.getBillersInitials=function(){i.getBillersInitials(e).then(function(t){n.alpha=t},function(){void 0})};n.getBillersByCategory=function(){i.getBillersByCategory(e).then(function(t){n.items=t},function(){void 0})};n.getBillersInitials();n.getBillersByCategory()}])}(),function(){"use strict";angular.module("billPaymentServices",[]).factory("BillPaymentFactory",["$http","$rootScope","API_URL","$q","SharedFunctions","localStorageService",function(n,t,i,r,u,f){var e,h=f.get("userInfo"),o={MerchantId:h.MerchantId,MerchantPassword:h.MerchantPassword},s={tracker:t.loadingTracker};return{getBillersByCategory:function(t){var f={MerchantId:o.MerchantId,MerchantPassword:o.MerchantPassword,CategoryId:t,BillerId:""},u=r.defer();return n.post(i+"BillPayment/GetBillersByCategory",f,s).then(function(n){e=n.data.Data;u.resolve(e)},function(n){void 0;u.reject(n)}),u.promise},getBillersInitials:function(t){var f={MerchantId:o.MerchantId,MerchantPassword:o.MerchantPassword,CategoryId:t,BillerId:""},u=r.defer();return n.post(i+"BillPayment/GetBillersInitials",f,s).then(function(n){e=n.data.Data;u.resolve(e)},function(n){void 0;u.reject(n)}),u.promise},getBillPaymentCategories:function(){var u={MerchantId:o.MerchantId,MerchantPassword:o.MerchantPassword},t=r.defer();return n.post(i+"BillPayment/GetBillPaymentCategories",u,s).then(function(n){e=n.data.Data;void 0;t.resolve(e)},function(n){void 0;t.reject(n)}),t.promise},getMasterBiller:function(t){var f={MerchantId:o.MerchantId,MerchantPassword:o.MerchantPassword,CategoryId:"",BillerId:t},u=r.defer();return n.post(i+"BillPayment/getMasterBiller",f,s).then(function(n){e=n.data;u.resolve(e)},function(n){void 0;u.reject(n)}),u.promise},getBillerPaymentOptions:function(t){var f={MerchantId:o.MerchantId,MerchantPassword:o.MerchantPassword,CategoryId:"",BillerId:t},u=r.defer();return n.post(i+"BillPayment/GetBillerPaymentOptions",f,s).then(function(n){e=n.data;u.resolve(e)},function(n){void 0;u.reject(n)}),u.promise},doBillPaymentNextStep:function(t){var f=t,u;return f.MerchantId=o.MerchantId,f.MerchantPassword=o.MerchantPassword,void 0,u=r.defer(),n.post(i+"BillPayment/DoBillPaymentNextStep",f,s).then(function(n){e=n.data;u.resolve(e)},function(n){void 0;u.reject(n)}),u.promise},doBillPayment:function(t){var f=t,u;return f.MerchantId=o.MerchantId,f.MerchantPassword=o.MerchantPassword,u=r.defer(),n.post(i+"BillPayment/DoBillPayment",f,s).then(function(n){e=n.data;u.resolve(e)},function(n){void 0;u.reject(n)}),u.promise}}}])}(),function(){"use strict";angular.module("posApp").controller("IndexByPopularBillPaymentCtrl",["$scope","$routeParams","BillPaymentFactory","Flash",function(n,t,i,r){r.dismiss();n.useMostPopular=!1;n.isMostPopular=!0;n.showAcronym=!1;n.useConfig=!0;n.getBillPaymentCategories=function(){i.getBillPaymentCategories().then(function(t){n.items=t;var i=t.length;switch(i){case 2:n.thumbWidth=6;break;case 4:n.thumbWidth=6;break;case 6:n.thumbWidth=3;break;case 8:n.thumbWidth=3;break;default:n.thumbWidth=2}void 0},function(){void 0})};n.getBillPaymentCategories()}])}(),function(){"use strict";angular.module("posApp").controller("IndexCategoriesBillPaymentCtrl",["$scope","$routeParams","BillPaymentFactory","Flash","$location",function(n,t,i,r,u){r.dismiss();n.useMostPopular=!0;n.isMostPopular=!1;n.useAcronym=!1;n.useConfig=!1;n.type=u.path().split("/").splice(1,1).toString();n.mostpopular="category/popular";n.setFilter=function(t){n.letter=t};n.showFilter=function(){n.showAcronymFilter=!n.showAcronymFilter};n.getBillPaymentCategories=function(){i.getBillPaymentCategories().then(function(t){n.items=t;var i=t.length;switch(i){case 2:n.thumbWidth=6;break;case 4:n.thumbWidth=6;break;case 6:n.thumbWidth=3;break;case 8:n.thumbWidth=3;break;default:n.thumbWidth=2}},function(){void 0})};n.getBillPaymentCategories()}])}(),function(){"use strict";angular.module("posApp").controller("ShowBillPaymentCtrl",["$scope","$routeParams","BillPaymentFactory","Flash",function(n,t,i,r){function f(){n.accountNumber.value||(n.accountNumber.value="");n.accountMatch.value||(n.accountMatch.value="");n.amount.value||(n.amount.value="")}function e(){var t=n.accountNumber.value.length,i=n.accountNumber.value;n.accountNumber.value=i.substring(0,t-1)}function o(){var t=n.accountMatch.value.length,i=n.accountMatch.value;void 0;void 0;n.accountMatch.value=i.substring(0,t-1)}function s(){var t=n.amount.value.length,i=n.amount.value;void 0;void 0;n.amount.value=i.substring(0,t-1)}function h(t){n.accountNumber.value=n.accountNumber.value+t}function c(t){void 0;n.accountMatch.value=n.accountMatch.value+t}function l(t){n.amount.value=n.amount.value+t}function a(t){void 0;n.amount.isFocused?l(t):n.accountNumber.isFocused?h(t):c(t)}r.dismiss();n.isMostPopular=!1;n.showAcronymFilter=!1;n.useAcronymFilter=!1;n.useConfig=!1;n.numLimit=25;var u=t.biller;n.showPaymentOptions=!0;n.showPaymentDetails=!1;n.hasKeyPad=!0;n.showKeypad=!0;n.showAdditionalDataForm=!1;n.showReceipt=!1;n.isDisableInputs=!1;n.accountNumber={value:null,isFocused:!1};n.accountMatch={value:null,isFocused:!1};n.amount={value:null,isFocused:!1};n.paymentType={value:null};n.date=new Date;n.editing=null;n.editItem=function(t){n.editing=t;void 0};n.onInputClick=function(n){n.target.select()};n.setKey=function(n){f();a(n)};n.clearKey=function(){n.accountNumber.isFocused?n.accountNumber.value="":n.amount.value=""};n.backKey=function(){f();n.accountNumber.isFocused?e():n.amount.isFocused?s():o()};n.setFocusedInput=function(t){t==="amount"?(n.accountNumber.isFocused=!1,n.accountMatch.isFocused=!1,n.amount.isFocused=!0,void 0):t==="accountNumber"?(n.accountMatch.isFocused=!1,n.accountNumber.isFocused=!0,n.amount.isFocused=!1,void 0):t==="accountMatch"&&(n.accountNumber.isFocused=!1,n.accountMatch.isFocused=!0,n.amount.isFocused=!1,void 0)};n.leaveInputsFocus=function(){n.accountNumber.isFocused=!1;n.accountMatch.isFocused=!1;n.amount.isFocused=!1};n.setAmount=function(t){void 0;n.amount=n.amount===t?undefined:t};n.getMasterBiller=function(){i.getMasterBiller(u).then(function(t){t.Status===201?(r.create("error",t.ErrorMessage+" for "+u,""),void 0):n.item=t.Data},function(){void 0})};n.getBillerPaymentOptions=function(){i.getBillerPaymentOptions(u).then(function(t){n.paymentOptions=t.Data},function(){void 0})};n.getBillerPaymentOptions();n.getMasterBiller();n.parseFloat=function(n){return parseFloat(n)};n.fee="0";n.paymentType=null;n.setPaymentOption=function(t){n.fee=t.FeeAmount;n.paymentType=t.PaymentType;n.showPaymentDetails=!0};n.doBillPaymentNextStep=function(t){if(n.submitted=!0,t.$invalid){r.create("error","Check errors below (in red color)","");return}var f={CategoryId:"",BillerId:u,AccountNumber:n.accountNumber.value,Amount:n.amount.value,PaymentFee:n.fee};i.doBillPaymentNextStep(f).then(function(t){t.Status===200?(n.showKeypad=!1,n.isDisableInputs=!0,n.aditionalDataRequired=t.Data,n.showAdditionalDataForm=!0):(r.create("error",t.ErrorMessage,""),n.isDisableInputs=!1)},function(){void 0})};n.setDefaults=function(){n.customer="";n.sender="";n.altLookUp="";n.addInfo1="";n.addInfo2=""};n.setDefaults();n.doBillPayment=function(t){if(n.submitted=!0,t.$invalid)return r.create("error","Check errors below (in red color)",""),!1;var f={CategoryId:"",BillerId:u,AccountNumber:n.accountNumber.value,Amount:n.amount.value,PaymentFee:n.fee,CustomerName:n.customer,SenderName:n.sender,AltLookUp:n.altLookUp,AddInfo1:n.addInfo1,AddInfo2:n.addInfo2};void 0;i.doBillPayment(f).then(function(t){t.Status===200||t.Status===203?(n.showPaymentOptions=!1,n.showAdditionalDataForm=!1,n.showReceipt=!0,n.receipt=t.Data):(r.create("error",t.ErrorMessage,""),n.showKeypad=!0,n.isDisableInputs=!1,n.showAdditionalDataForm=!1,void 0)},function(){void 0})};n.printInfo=function(){window.print()};n.termsOfPersonalData="Customer accepts to receive transaction confirmation and other important account messages"}])}(),function(){"use strict";angular.module("posApp").controller("IndexDirectTvCategoriesCtrl",["$scope","$routeParams","DirectTvFactory","AlertService","$location",function(n,t,i,r,u){r.clear();n.useMostPopular=!1;n.isMostPopular=!1;n.useAcronym=!1;n.useConfig=!1;n.type=u.path().split("/").splice(1,1).toString();n.mostpopular="category/popular";n.getDirectTvCategories=function(){i.getDirectTvCategories().then(function(t){n.items=t},function(){void 0})};n.getDirectTvCategories()}]).controller("IndexDirectTvByCategoryCtrl",["$scope","$routeParams","DirectTvFactory","ProdsFactory","AlertService","$location",function(n,t,i,r,u,f){n.useMostPopular=!0;n.isMostPopular=!0;n.useAcronym=!1;n.showAcronym=!0;n.useConfig=!0;n.configPath="categories";n.configDisplay="Category";n.type=f.path().split("/").splice(1,1).toString();n.mostpopular="popular";var e=t.category;n.getDirectTvProductsByCategory=function(){i.getDirectTvProductsByCategory(e).then(function(t){n.items=t;void 0},function(){void 0})};n.getDirectTvProductsByCategory()}]).controller("showDirectTvCtrl",["$scope","DirectTvFactory","ProdsFactory","$routeParams","AlertService","localStorageService","SharedFunctions","$modal","ConfirmationFactory",function(n,t,i,r,u,f,e,o,s){var h=r.product;n.getDirectTvProduct=function(){t.getDirectTvProduct(h).then(function(t){n.item=t},function(){void 0})};n.getDirectTvProduct();n.submit=function(t){if(void 0,n.submitted=!0,t.$invalid){u.clear();u.add("error","Check errors below (in red color)");return}n.isBlocked=!0;u.clear();var r=f.get("userInfo"),e={MerchantId:r.MerchantId,MerchantPassword:r.MerchantPassword,OperatorName:r.userName,ProfileId:r.profileId,TerminalId:r.terminalId,Amount:n.item.price,ProductMainCode:n.item.id};void 0;i.doBlackstonePosOperation(e).then(function(t){if(t.Status===200||t.Status===203){var i=t.Status===200?"Order processed!":"Order placed. Pending for further Execution!";n.showReceipt=!0;n.submitted=!1;u.add("success",i);n.receipt=t.Data}else u.add("error",t.ErrorMessage),n.isBlocked=!1},function(){n.isBlocked=!1;u.add("error","Invalid Credentials");void 0});n.showReceipt=!1};n.printInfo=function(){window.print()};n.sendSms=function(t){if(n.submittedSms=!0,t.$invalid){u.clear();u.add("error","Check form errors");return}u.clear();var i=n.receipt,r=n.phoneToSend;s.sendConfirmationSms(i,r).then(function(t){u.clear();n.submittedSms=!1;t.Status===200?u.add("success","The Receipt has been sent as sms successfully!"):u.add("error","Sorry, an error has happened. Please, try again.");void 0},function(n){u.add("error",n.ErrorMessage);void 0})};n.sendEmail=function(t){if(n.submittedEmail=!0,t.$invalid){u.clear();u.add("error","Check form errors");return}u.clear();var i=n.receipt,r=n.emailToSend;s.sendConfirmationEmail(i,r).then(function(t){u.clear();n.submittedEmail=!1;t.Status===200?u.add("success","The Receipt has been sent as email successfully!"):u.add("error","Sorry, an error has happened. Please, try again.");void 0},function(n){u.add("error",n.ErrorMessage);void 0})};n.open=function(t){var r={firstItem:n.item.productName,secondItem:null,thirdItem:n.item.price},i;t=angular.extend(t,r);i=o.open({templateUrl:"./app/products/_modal-product-tpl.html",controller:"ModalInstanceCtrl",size:"lg",windowClass:"product-modal",resolve:{item:function(){return t}}});i.result.then(function(t){n.selected=t},function(){})}}])}(),function(){"use strict";angular.module("directTvServices",[]).factory("DirectTvFactory",["$http","$rootScope","API_URL","$q","SharedFunctions","localStorageService",function(n,t,i,r,u,f){var e=[],h=f.get("userInfo"),o={MerchantId:h.MerchantId,MerchantPassword:h.MerchantPassword},s={tracker:t.loadingTracker};return{getDirectTvAllProducts:function(t){var f={MerchantId:o.MerchantId,MerchantPassword:o.MerchantPassword,CategoryId:t},u=r.defer();return n.post(i+"DirectTv/GetDirectTvAllProducts",f,s).then(function(n){e=n.data.Data;u.resolve(e)},function(n){void 0;u.reject(n)}),u.promise},getDirectTvCategories:function(){var u={MerchantId:o.MerchantId,MerchantPassword:o.MerchantPassword},t=r.defer();return n.post(i+"DirectTv/GetDirectTvCategories",u,s).then(function(n){e=n.data.Data;void 0;t.resolve(e)},function(n){t.reject(n)}),t.promise},getDirectTvProductsByCategory:function(t){var f={MerchantId:o.MerchantId,MerchantPassword:o.MerchantPassword,Category:t},u=r.defer();return n.post(i+"DirectTv/GetDirectTvProductsByCategory",f,s).then(function(n){e=n.data.Data;u.resolve(e)},function(n){void 0;u.reject(n)}),u.promise},getDirectTvProduct:function(t){var f={MerchantId:o.MerchantId,MerchantPassword:o.MerchantPassword,ProductMainCode:t},u=r.defer();return n.post(i+"DirectTv/GetDirectTvProduct",f,s).then(function(n){e=n.data.Data;void 0;u.resolve(e)},function(n){void 0;u.reject(n)}),u.promise}}}])}(),function(){"use strict";angular.module("posApp").controller("HomeCtrl",["$scope","$location","AlertService","ProdsFactory","localStorageService","ExternalFactory",function(n,t,i,r,u,f){var e,o;i.clear();e=u.get("userInfo");n.getActivationShopUrl=function(){f.getActivationShopUrl(e.merchantId,e.password).then(function(t){var i=t;n.activationShopUrl=i},function(){void 0})};n.getActivationShopUrl();n.getVonageUrl=function(){f.getVonageUrl(e.merchantId,e.password).then(function(t){var i=t;n.vonageUrl=i},function(){void 0})};o=[{categoryName:"billpayment",title:"Bill Payment",url:"#/billpayment/categories",position:1,icon:""},{categoryName:"international",title:"Int'l Top Up",url:"#/pos/category/international/countries",position:2,icon:""},{categoryName:"pinless",title:"Pinless Recharge",url:"#/pos/category/pinless",position:4,icon:""},{categoryName:"longdistance",title:"Long Distance",url:"#/pos/category/longdistance/countries",position:3,icon:""},{categoryName:"wireless",title:"Wireless Recharge",url:"#/pos/category/wireless/carriers",position:6,icon:""},{categoryName:"sunPass",title:"SunPass",url:"#/sunpass",position:5,icon:""},{categoryName:"promotions",title:"Specials",url:"#/pos/category/promotions",position:8,icon:"star"},{categoryName:"directtv",title:"Direct TV",url:"#/directtv/categories",position:9,icon:""}];n.getMainProducts=function(t){n.items=[];var i=[];r.getPosMainProducts(e.MerchantId,e.MerchantPassword).then(function(r){i=r;for(var u=0;u<t.length;u++)i.indexOf(t[u].categoryName)>=0&&n.items.push(t[u])},function(){void 0})};n.getMainProducts(o);n.addAlert=function(){i.add("success","Welcome!"+e.Name+"This is a success message!")};n.filterables=[{name:"Rate",value:"rate"},{name:"Country",value:"countryName"},{name:"Category",value:"category"}];n.selectProduct=function(n){u.set("selection",n)}}])}(),function(){"use strict";angular.module("posApp").controller("LoginCtrl",["$scope","AlertService","$location","AuthenticationFactory","localStorageService","$rootScope","SITE_URL","$modal",function(n,t,i,r,u,f,e,o){function s(n){if(n.Status===200){var i=n.UserInfo;console.log(i);u.set("userInfo",i);t.add("success","Welcome!")}else t.add("error","Invalid Credentials!"),void 0}t.clear();n.isApplying=!1;n.toggleApplication=function(){n.isApplying=!n.isApplying};n.closeAlert=function(t){n.alerts.splice(t,1)};n.submitLogin=function(f){if(n.submitted=!0,f.$invalid){t.clear();t.add("error","Check errors below");return}f.$valid&&(t.clear(),r.login(f.user.$modelValue,f.password.$modelValue).then(function(n){if(n.Status===200){var r=n.UserInfo;u.set("userInfo",r);void 0;console.log(r);i.path("/")}else t.add("error","Invalid Credentials!")},function(){t.add("error","Invalid Credentials");void 0}))};n.loginDemo=function(){void 0;t.clear();r.login(834,"M5494").then(function(n){s(n);location.href="google.com"},function(){t.add("error","Invalid Credentials");void 0})};n.submitted=!1;n.applicantSubmit=function(i){if(n.submitted=!0,i.$invalid){t.clear();t.add("error","Check errors below");return}if(i.$valid){t.clear();var u={Name:i.user.$modelValue,PhoneNumber:i.phone.$modelValue,Email:i.email.$modelValue,Address:i.address.$modelValue,State:i.state.$modelValue,ZipCode:i.zip.$modelValue};r.submitApplicant(u).then(function(n){n.Status===200&&(t.clear(),t.add("success","Application Successfully submited!"))},function(){t.add("error","Problems processing your application. Try again later, please.");void 0})}};n.open=function(t){var i=o.open({templateUrl:"./app/login/_modal-demo-tpl.html",controller:"ModalFormInstanceCtrl",size:"sm",windowClass:"demo-modal",resolve:{item:function(){return t}}});i.result.then(function(t){n.selected=t},function(){void 0})};n.demoAcccess=[{category:"international",categoryName:"International Top Up",caption:"Instantly load International wireless phones for over 200 Countries worldwide.",imageUrl:"Images/landing/01a-bkt-POS-landing.png"},{category:"wireless",categoryName:"Wireless",caption:"Load prepaid pay-as-you-go wireless accounts! Offer a wide variety of carriers.",imageUrl:"Images/landing/pinless.png"},{category:"longdistance",categoryName:"Long Distance",caption:"Load prepaid pay-as-you-go wireless accounts! Offer Variety of carriers.",imageUrl:"Images/landing/03a-bkt-POS-landing.png"},{category:"pinless",categoryName:"Pinless",caption:"A low-cost prepaid calling card program that does not require a PIN or scratch-off card.",imageUrl:"Images/landing/04a-bkt-POS-landing.png"}];n.states=[{name:"Alabama",abb:"AL"},{name:"Alaska",abb:"AK"},{name:"Arizona",abb:"AZ"},{name:"Arkansas",abb:"AR"},{name:"California",abb:"CA"},{name:"Colorado",abb:"CO"},{name:"Connecticut",abb:"CT"},{name:"Delaware",abb:"DE"},{name:"District Of Columbia",abb:"DC"},{name:"Florida",abb:"FL"},{name:"Georgia",abb:"GA"},{name:"Hawaii",abb:"HI"},{name:"Idaho",abb:"ID"},{name:"Illinois",abb:"IL"},{name:"Indiana",abb:"IN"},{name:"Iowa",abb:"IA"},{name:"Kansas",abb:"KS"},{name:"Kentucky",abb:"KY"},{name:"Louisiana",abb:"LA"},{name:"Maine",abb:"ME"},{name:"Maryland",abb:"MD"},{name:"Massachusetts",abb:"MA"},{name:"Michigan",abb:"MI"},{name:"Minnesota",abb:"MN"},{name:"Mississippi",abb:"MS"},{name:"Missouri",abb:"MO"},{name:"Montana",abb:"MT"},{name:"Nebraska",abb:"NE"},{name:"Nevada",abb:"NV"},{name:"New Hampshire",abb:"NH"},{name:"New Jersey",abb:"NJ"},{name:"New Mexico",abb:"NM"},{name:"New York",abb:"NY"},{name:"North Carolina",abb:"NC"},{name:"North Dakota",abb:"ND"},{name:"Ohio",abb:"OH"},{name:"Oklahoma",abb:"OK"},{name:"Oregon",abb:"OR"},{name:"Pennsylvania",abb:"PA"},{name:"Rhode Island",abb:"RI"},{name:"South Carolina",abb:"SC"},{name:"South Dakota",abb:"SD"},{name:"Tennessee",abb:"TN"},{name:"Texas",abb:"TX"},{name:"Utah",abb:"UT"},{name:"Vermont",abb:"VT"},{name:"Virginia",abb:"VA"},{name:"Washington",abb:"WA"},{name:"West Virginia",abb:"WV"},{name:"Wisconsin",abb:"WI"},{name:"Wyoming",abb:"WY"}]}]).controller("ModalFormInstanceCtrl",["$scope","$location","$modalInstance","item","SITE_URL","AuthenticationFactory","AlertService","localStorageService",function(n,t,i,r,u,f,e,o){var s=r;n.modalOptions={closeButtonText:"Close",actionButtonText:"Submit",headerText:i.headerText};n.close=function(){i.close()};n.guestSubmit=function(n){if(n.$invalid){e.clear();e.add("error","Check errors below");return}if(n.$valid){var t={Name:n.user.$modelValue,Email:n.email.$modelValue,MerchantId:834,MerchantPassword:"M5494"};f.submitGuest(t).then(function(n){n.Status===200&&(e.clear(),e.add("success","Application Successfully submited!"))},function(){void 0});f.login(834,"M5494").then(function(n){var t,r;n.Status===200&&(t=n.UserInfo,o.set("userInfo",t),i.close(),r=u+"#/pos/category/"+s,void 0,window.location=r)},function(){e.add("error","Invalid Credentials");void 0})}}}])}(),function(){"use strict";angular.module("loginServices",[]).factory("AuthenticationFactory",["$http","$rootScope","API_URL","$q","localStorageService",function(n,t,i,r,u){var e,f,o={tracker:t.loadingTracker};return{login:function(t,u){var s=r.defer();return n.post(i+"Merchant/GetMerchantDetails",{MerchantId:t,MerchantPassword:u},o).then(function(n){n.data.Data!=null&&(f={Name:n.data.Data.Name,MerchantId:n.data.Data.MerchantId,MerchantPassword:n.data.Data.MerchantPassword,ProfileId:n.data.Data.MerchantProfileId,TerminalId:n.data.Data.MerchantTerminalId,Status:n.data.Data.Status,Id:n.data.Data.Id,TimeStamp:n.data.Data.TimeStamp,IsMerchant:n.data.Data.IsMerchant,BusinessName:n.data.Data.MerchantBusinessName,IsFullCarga:n.data.Data.IsFullCarga,CustomerService:n.data.Data.CustomerService});e={Status:n.data.Status,UserInfo:f};s.resolve(e)},function(n){s.reject(n)}),s.promise},isLoggedIn:function(){f=u.get("userInfo");return f!=null?f:!1},getUserInfo:function(){return u.get("userInfo")&&(f=u.get("userInfo")),f},submitApplicant:function(t){var u=r.defer();return n.post(i+"guest/submitapplication",t).then(function(n){e=n.data;u.resolve(e)},function(n){u.reject(n)}),u.promise},submitGuest:function(t){var u=r.defer();return n.post(i+"guest/submitguest",t).then(function(n){e=n.data;u.resolve(e)},function(n){u.reject(n)}),u.promise}}}])}(),function(){"use strict";angular.module("posApp").controller("OthersCtrl",["$scope","AlertService",function(n,t){t.clear();t.add("info","Nothing to do...")}])}(),function(){"use strict";angular.module("posApp").controller("IndexByCategoryByCarrierCtrl",["$scope","$routeParams","ProdsFactory","AlertService","localStorageService","$location",function(n,t,i,r,u,f){var e,o;r.clear();e=t.carrier;n.useMostPopular=!0;n.isMostPopular=!1;n.useConfig=!0;n.useAcronymFilter=!0;n.showAcronymFilter=!0;n.viewsearch="carriers";n.selectdisplay="carrier";n.type=f.path().split("/").splice(1,1).toString();n.category=t.category;n.mostpopular="category/"+n.category;o=u.get("userInfo");n.getWirelessCarrierDetails=function(){i.getWirelessCarrierDetails(e,o).then(function(t){n.details=t},function(){void 0})};n.getWirelessProductsByCarrier=function(){i.getWirelessProductsByCarrier(e,o).then(function(t){n.items=t},function(){void 0})};n.getWirelessProductsByCarrier()}])}(),function(){"use strict";angular.module("posApp").controller("IndexByCategoryByCountryCtrl",["$scope","$routeParams","ProdsFactory","AlertService","localStorageService","SharedFunctions","$location",function(n,t,i,r,u,f,e){var o,s,h;r.clear();o=t.category;s=t.country;n.useMostPopular=!0;n.isMostPopular=!1;n.useConfig=!0;n.useAcronymFilter=!0;n.showAcronymFilter=!0;n.selectdisplay="country";n.configDisplay="Country";n.configPath="category/"+o+"/countries";n.viewsearch="countries";n.type=e.path().split("/").splice(1,1).toString();n.category=o;n.mostpopular="category/"+o;h=u.get("userInfo");n.getCountryDetails=function(){i.getCountryDetails(o,s,h).then(function(t){n.details=t},function(){void 0})};n.getProductInitialsByCategoryByCountry=function(){i.getProductInitialsByCategoryByCountry(o,s,h).then(function(t){n.alpha=t},function(){void 0})};n.getProductsByCategoryByCountry=function(){i.getProductsByCategoryByCountry(o,s,h).then(function(t){n.items=t},function(){void 0})};n.getProductsByCategoryByCountry()}])}(),function(){"use strict";angular.module("posApp").controller("IndexByCategoryCtrl",["$scope","$routeParams","ProdsFactory","AlertService","SharedFunctions","$location","localStorageService",function(n,t,i,r,u,f,e){var o,h,s;r.clear();n.useMostPopular=!0;n.isMostPopular=!0;n.showAcronym=!1;n.useAcronym=!0;n.useConfig=t.category==="pinless"?!1:!0;o=t.category;h=o==="longdistance"||o==="international"?"countries":"carriers";n.configDisplay=o==="longdistance"||o==="international"?"country":"carrier";n.configPath="category/"+o+"/"+h;n.type=f.path().split("/").splice(1,1).toString();n.mostpopular="category/"+o;s=e.get("userInfo");n.viewsearch=o==="wireless"?"carriers":"countries";n.activeClass=function(t){return t===n.letter?" active":"cosa"};n.getProductInitialsByCategory=function(){i.getProductInitialsByCategory(o,s).then(function(t){n.alpha=t},function(){void 0})};n.getAllProducts=function(){i.getAllProducts(o,s).then(function(t){n.items=t},function(){void 0})};n.getProductInitialsByCategory();n.getAllProducts()}])}(),function(){"use strict";angular.module("posApp").controller("IndexCountriesByCategoryCtrl",["$scope","$routeParams","ProdsFactory","AlertService","localStorageService","SharedFunctions","$location",function(n,t,i,r,u,f,e){var o,s;r.clear();o=t.category;n.useMostPopular=!0;n.isMostPopular=!1;n.useAcronym=!0;n.showAcronym=!0;n.useConfig=!1;n.type=e.path().split("/").splice(1,1).toString();n.category=o;n.mostpopular="category/"+o;s=u.get("userInfo");n.activeClass=function(t){return t===n.letter?" active":"cosa"};n.getCountryInitialsByCategory=function(){i.getCountryInitialsByCategory(o,s).then(function(t){n.alpha=t},function(){void 0})};n.getCountriesByCategory=function(){i.getCountriesByCategory(o,s).then(function(t){n.items=t},function(){void 0})};n.getCountryInitialsByCategory();n.getCountriesByCategory()}])}(),function(){"use strict";angular.module("posApp").controller("IndexByCarriersCtrl",["$scope","$routeParams","ProdsFactory","AlertService","localStorageService","SharedFunctions","$location",function(n,t,i,r,u,f,e){var h,o,s;r.clear();n.letter="";n.useMostPopular=!0;n.isMostPopular=!1;n.useConfig=!1;n.useAcronym=!0;n.showAcronym=!0;n.viewsearch="carriers";n.selectdisplay="carrier";n.type=e.path().split("/").splice(1,1).toString();h=t.category;n.mostpopular="category/"+h;o="USA";s=u.get("userInfo");n.activeClass=function(t){return t===n.letter?" active":"cosa"};n.getWirelessCarrierInitials=function(){i.getWirelessCarrierInitials(o,s).then(function(t){n.alpha=t},function(){void 0})};n.getWirelessCarriers=function(){i.getWirelessCarriers(o,s).then(function(t){n.items=t},function(){void 0})};n.getWirelessCarrierInitials();n.getWirelessCarriers()}])}(),function(){"use strict";angular.module("prodsServices",[]).factory("ProdsFactory",["$http","$rootScope","API_URL","$q","SharedFunctions","localStorageService",function(n,t,i,r,u,f){var e,s,h,c,l,o={tracker:t.loadingTracker};return this.initialize=function(){var n=f.get("userInfo");u.isobject(n)&&(l={MerchantId:n.MerchantId,MerchantPassword:n.MerchantPassword})},{getProductsByCategoryByCountry:function(t,u,f){var s={MerchantId:f.MerchantId,MerchantPassword:f.MerchantPassword,Category:t,CountryCode:u},e=r.defer();return n.post(i+"Products/GetProductsByCategoryByCountry",s,o).then(function(n){h=n.data.Data;e.resolve(h)},function(n){void 0;e.reject(n)}),e.promise},getProduct:function(t,u){var e={MerchantId:u.MerchantId,MerchantPassword:u.MerchantPassword,ProductMainCode:t},f=r.defer();return n.post(i+"Products/GetProduct",e,o).then(function(n){s=n.data.Data;f.resolve(s)},function(n){f.reject(n)}),f.promise},getProductTerms:function(t,u){var e={MerchantId:u.MerchantId,MerchantPassword:u.MerchantPassword,ProductMainCode:t},f=r.defer();return n.post(i+"Products/GetProduct",e,o).then(function(n){s=n.data.Data;f.resolve(s)},function(n){f.reject(n)}),f.promise},getProductRates:function(t,u){var e={MerchantId:u.MerchantId,MerchantPassword:u.MerchantPassword,ProductMainCode:t},f=r.defer();return n.post(i+"Products/GetProductRates",e,o).then(function(n){var t=n.data.Data;f.resolve(t)},function(n){f.reject(n)}),f.promise},getProductAccessNumbers:function(t,u){var e={MerchantId:u.MerchantId,MerchantPassword:u.MerchantPassword,ProductMainCode:t},f=r.defer();return n.post(i+"Products/GetProductAccessNumbers",e,o).then(function(n){var t=n.data.Data;f.resolve(t)},function(n){f.reject(n)}),f.promise},getAllProducts:function(t,u){var e={MerchantId:u.MerchantId,MerchantPassword:u.MerchantPassword,Category:t},f=r.defer();return n.post(i+"Products/GetAllProducts",e,o).then(function(n){h=n.data.Data;f.resolve(h)},function(n){f.reject(n);void 0}),f.promise},getProductInitialsByCategory:function(t,u){var s={MerchantId:u.MerchantId,MerchantPassword:u.MerchantPassword,Category:t},f=r.defer();return n.post(i+"Products/GetProductInitialsByCategory",s,o).then(function(n){e=n.data.Data;f.resolve(e)},function(n){f.reject(n);void 0}),f.promise},getProductInitialsByCategoryByCountry:function(t,u,f){var h={MerchantId:f.MerchantId,MerchantPassword:f.MerchantPassword,Category:t,CountryCode:u},s=r.defer();return n.post(i+"Products/GetProductInitialsByCategoryByCountry",h,o).then(function(n){e=n.data.Data;s.resolve(e)},function(n){s.reject(n);void 0}),s.promise},getCarriers:function(t,u){var s={MerchantId:u.MerchantId,MerchantPassword:u.MerchantPassword,Category:t},f=r.defer();return n.post(i+"Products/GetCarriers",s,o).then(function(n){e=n.data.Data;void 0;f.resolve(e)},function(n){void 0;f.reject(n)}),f.promise},getCountriesByCategory:function(t,u){var s={MerchantId:u.MerchantId,MerchantPassword:u.MerchantPassword,Category:t},f=r.defer();return n.post(i+"Products/GetCountriesByCategory",s,o).then(function(n){e=n.data.Data;f.resolve(e)},function(n){void 0;f.reject(n)}),f.promise},getCountryInitialsByCategory:function(t,u){var o={MerchantId:u.MerchantId,MerchantPassword:u.MerchantPassword,Category:t},f=r.defer();return n.post(i+"Products/GetCountryInitialsByCategory",o).then(function(n){e=n.data.Data;f.resolve(e)},function(n){void 0;f.reject(n)}),f.promise},getRates:function(t,u){var s={MerchantId:u.MerchantId,MerchantPassword:u.MerchantPassword,ProductMainCode:t},f=r.defer();return n.post(i+"Products/GetProductRates",s,o).then(function(n){e=n.data;f.resolve(e)},function(n){void 0;f.reject(n)}),f.promise},getLongDistanceCountries:function(t){var f={MerchantId:t.MerchantId,MerchantPassword:t.MerchantPassword},u=r.defer();return n.post(i+"Products/GetLongDistanceCountries",f,o).then(function(n){c=n.data.Data;u.resolve(c)},function(n){u.reject(n)}),u.promise},getLongDistanceProductsByCountry:function(t,u){var s={MerchantId:u.MerchantId,MerchantPassword:u.MerchantPassword,CountryName:t},f=r.defer();return n.post(i+"Products/GetLongDistanceProductsByCountry",s,o).then(function(n){e=n.data.Data;f.resolve(e)},function(n){f.reject(n)}),f.promise},getCountryDetails:function(t,u,f){var h={MerchantId:f.MerchantId,MerchantPassword:f.MerchantPassword,Category:t,CountryCode:u},s=r.defer();return n.post(i+"Products/GetCountryDetailsByCategory",h,o).then(function(n){e=n.data.Data;s.resolve(e)},function(n){s.reject(n)}),s.promise},getWirelessCarriers:function(t,u){var s={MerchantId:u.MerchantId,MerchantPassword:u.MerchantPassword,CountryCode:t},f=r.defer();return n.post(i+"Products/GetWirelessCarriers",s,o).then(function(n){e=n.data.Data;f.resolve(e)},function(n){void 0;f.resolve(n)}),f.promise},getWirelessProductsByCarrier:function(t,u){var s={MerchantId:u.MerchantId,MerchantPassword:u.MerchantPassword,CarrierId:t},f=r.defer();return n.post(i+"Products/GetWirelessProductsByCarrier",s,o).then(function(n){e=n.data.Data;void 0;f.resolve(e)},function(n){void 0;f.reject(n)}),f.promise},getWirelessCarrierDetails:function(t,u){var s={MerchantId:u.MerchantId,MerchantPassword:u.MerchantPassword,CarrierId:t},f=r.defer();return n.post(i+"Products/GetWirelessCarrierDetails",s,o).then(function(n){e=n.data.Data;f.resolve(e)},function(n){void 0;f.reject(n)}),f.promise},getWirelessCarrierInitials:function(t,u){var s={MerchantId:u.MerchantId,MerchantPassword:u.MerchantPassword,CountryCode:t},f=r.defer();return n.post(i+"products/GetWirelessCarrierInitials",s,o).then(function(n){e=n.data.Data;void 0;f.resolve(e)},function(n){void 0;f.reject(n)}),f.promise},doBlackstonePosOperation:function(t){void 0;var u=r.defer();return n.post(i+"Products/DoBlackstonePosOperation",t,o).then(function(n){var t=n.data;u.resolve(t)},function(n){void 0;u.reject(n)}),u.promise},getPosMainProducts:function(t,u){t={MerchantId:t,MerchantPassword:u};var f=r.defer();return n.post(i+"Products/GetPosMainProducts",t,o).then(function(n){var t=n.data.Data;f.resolve(t)},function(n){void 0;f.reject(n)}),f.promise}}}])}(),function(){"use strict";angular.module("posApp").controller("ShowProductCtrl",["$scope","$routeParams","$modal","ProdsFactory","AlertService","localStorageService","SharedFunctions","ConfirmationFactory","SettingsFactory",function(n,t,i,r,u,f,e,o,s){function c(){n.phoneNumber.value||(n.phoneNumber.value="");n.amount.value||(n.amount.value="");n.phoneMatch.value||(n.phoneMatch.value="")}function a(t){var i=r.getProductRates(t,h).then(function(t){var i={Name:n.item.Name,CountryName:n.item.CountryName,CarrierName:n.item.CarrierName};return angular.extend(t,i)},function(){void 0});return void 0,i}function v(t){return r.getProductAccessNumbers(t,h).then(function(t){var i={Name:n.item.Name,CountryName:n.item.CountryName,CarrierName:n.item.CarrierName};return angular.extend(t,i)},function(){void 0})}function y(t){void 0;n.phoneMatch.value=n.phoneMatch.value+t}function p(t){n.phoneNumber.value=n.phoneNumber.value+t}function w(t){n.amount.value=n.amount.value+t}function b(t){void 0;n.amount.isFocused?w(t):n.phoneNumber.isFocused?p(t):y(t)}function k(){var t=n.phoneNumber.value.length,i=n.phoneNumber.value;n.phoneNumber.value=i.substring(0,t-1)}function d(){var t=n.phoneMatch.value.length,i=n.phoneMatch.value;void 0;void 0;n.phoneMatch.value=i.substring(0,t-1)}function g(){var t=n.amount.value.length,i=n.amount.value;void 0;void 0;n.amount.value=i.substring(0,t-1)}u.clear();var l=t.id,h=f.get("userInfo");n.showReceipt=!1;n.isMobile=e.isMobile();n.oneAtATime=!0;n.status={isFirstOpen:!e.isMobile(),isFirstDisabled:!1};void 0;s.getSettings().then(function(t){var i=t;f.set("settings",i);n.settings=i},function(){void 0});n.getProduct=function(){r.getProduct(l,h).then(function(t){n.item=t;n.phoneNumber.value=n.phoneMatch.value=t.DialCountryCode;n.hasKeyPad=!t.UseFixedDenominations||t.IsTopUp;void 0},function(){void 0})};n.getProduct();n.phoneNumber={value:null,isFocused:!1};n.phoneMatch={value:null,isFocused:!1};n.amount={value:null,isFocused:!1};n.open=function(t){var u={firstItem:n.item.Name,secondItem:n.item.CountryName,thirdItem:n.item.CarrierName},r;t=angular.extend(t,u);void 0;r=i.open({templateUrl:"./app/products/_modal-product-tpl.html",controller:"ModalInstanceCtrl",size:"lg",windowClass:"product-modal",resolve:{item:function(){return t}}});r.result.then(function(t){n.selected=t},function(){})};n.openRates=function(t){var r=a(t),u=i.open({templateUrl:"./app/products/_modal-product-tpl.html",controller:"ModalInstanceCtrl",size:"lg",windowClass:"product-modal",resolve:{item:function(){return r}}});u.result.then(function(t){n.selected=t},function(){})};n.openAccessNumbers=function(t){for(var f,r=v(t),u=0;u<r.length;u++)delete r.languageField;f=i.open({templateUrl:"./app/products/_modal-product-tpl.html",controller:"ModalInstanceCtrl",size:"lg",windowClass:"product-modal",resolve:{item:function(){return r}}});f.result.then(function(t){n.selected=t},function(){})};n.openTerms=function(t){var r=i.open({templateUrl:"./app/shared/_modal-product-terms-tpl.html",controller:"ModalInstanceTermsCtrl",size:"lg",windowClass:"product-modal",resolve:{item:function(){return t}}});r.result.then(function(t){n.selected=t},function(){})};n.editing=null;n.editItem=function(t){n.editing=t;void 0};n.onInputClick=function(n){n.target.select()};n.setKey=function(n){c();b(n)};n.clearKey=function(){n.phoneNumber.isFocused?n.phoneNumber.value="":n.amount.value=""};n.backKey=function(){c();n.phoneNumber.isFocused?k():n.amount.isFocused?g():d()};n.setFocusedInput=function(t){t==="amount"?(n.phoneNumber.isFocused=!1,n.phoneMatch.isFocused=!1,n.amount.isFocused=!0):t==="phoneNumber"?(n.amount.isFocused=!1,n.phoneMatch.isFocused=!1,n.phoneNumber.isFocused=!0):t==="phoneMatch"&&(n.amount.isFocused=!1,n.phoneNumber.isFocused=!1,n.phoneMatch.isFocused=!0,void 0)};n.leaveInputsFocus=function(){n.amount.isFocused=!1;n.phoneNumber.isFocused=!1;n.phoneMatch.isFocused=!1};n.setAmount=function(t){void 0;n.amount=n.amount===t?undefined:t};n.submit=function(t){if(n.submitted=!0,t.$invalid){u.clear();return}n.isBlocked=!0;u.clear();var i={MerchantId:h.MerchantId,MerchantPassword:h.MerchantPassword,OperatorName:h.userName,ProfileId:h.profileId,TerminalId:h.terminalId,Amount:n.amount.value,PhoneNumber:n.phoneNumber.value,ProductMainCode:n.item.Code,CountryCode:n.item.DialCountryCode};r.doBlackstonePosOperation(i).then(function(t){if(t.Status===200||t.Status===203){var i=t.Status===200?"Order processed!":"Order placed. Pending for further Execution!";n.showReceipt=!0;void 0;n.submitted=!1;u.add("success",i);n.receipt=t.Data}else u.add("error",t.ErrorMessage),n.isBlocked=!1},function(){n.isBlocked=!1;u.add("error","Invalid Credentials");void 0});n.showReceipt=!1};n.printInfo=function(){window.print()};n.sendSms=function(t){if(n.submittedSms=!0,t.$invalid)return u.clear(),u.add("error","Check form errors"),!1;u.clear();var i=n.receipt,r=n.phoneToSend;o.sendConfirmationSms(i,r).then(function(t){u.clear();n.submittedSms=!1;t.Status===200?u.add("success","The Receipt has been sent as sms successfully!"):u.add("error","Sorry, an error has happened. Please, try again.");void 0},function(n){u.add("error",n.ErrorMessage);void 0})};n.sendEmail=function(t){if(n.submittedEmail=!0,t.$invalid)return u.clear(),u.add("error","Check form errors"),!1;u.clear();var i=n.receipt,r=n.emailToSend;o.sendConfirmationEmail(i,r).then(function(t){u.clear();n.submittedEmail=!1;t.Status===200?u.add("success","The Receipt has been sent as email successfully!"):u.add("error","Sorry, an error has happened. Please, try again.");void 0},function(n){u.add("error",n.ErrorMessage);void 0})}}])}(),function(){"use strict";angular.module("posApp").controller("ShowTermsCtrl",["$scope","$routeParams","ProdsFactory","AlertService","localStorageService",function(n,t,i,r,u){var f,e;r.clear();f=t.id;void 0;e=u.get("userInfo");n.getProductTerms=function(){i.getProductTerms(f,e).then(function(t){n.item=t;void 0},function(){void 0})};n.getProductTerms();n.printInfo=function(){window.print()}}])}(),function(){"use strict";angular.module("posApp").controller("PromosCtrl",["$scope","$routeParams","PromosFactory","AlertService",function(n,t,i,r){r.clear();n.getPromotions=function(){i.getPromotions().then(function(t){n.items=t},function(n){r.add("error",n);void 0})};n.getPromotions()}])}(),function(){"use strict";angular.module("promosServices",[]).factory("PromosFactory",["$http","$rootScope","API_URL","$q","SharedFunctions","localStorageService",function(n,t,i,r,u,f){var s={tracker:t.loadingTracker},e=f.get("userInfo"),h={MerchantId:e.MerchantId,MerchantPassword:e.MerchantPassword},o=[];return{getPromotions:function(){var t=r.defer();return n.post(i+"Promotions/GetAllPromotions",h,s).then(function(n){o=n.data.Data;t.resolve(o)},function(n){t.reject(n)}),t.promise}}}])}(),function(){"use strict";angular.module("posApp").controller("ModalAccountCtrl",["$scope","$modalInstance","item","$location","localStorageService",function(n,t,i,r,u){n.merchant=i;n.openAdmin=function(){t.close();r.path("/admin")};n.logout=function(){t.close();u.clearAll()};n.close=function(){t.close()};n.cancel=function(){t.dismiss("cancel")}}]).controller("ModalInstanceCtrl",["$scope","$modalInstance","item",function(n,t,i){n.items=i;n.selected={item:n.items};n.modalOptions={closeButtonText:"Close",actionButtonText:"Save",headerText:t.headerText};n.close=function(){t.close(n.selected.items)};n.cancel=function(){t.dismiss("cancel")}}]).controller("ModalInstanceTermsCtrl",["$scope","$modalInstance","item",function(n,t,i){n.items=i;n.selected={item:n.items};n.modalOptions={closeButtonText:"Close",actionButtonText:"Save",headerText:t.headerText};n.close=function(){t.close(n.selected.items)};n.cancel=function(){t.dismiss("cancel")}}]).controller("MainCtrl",["$rootScope","$scope","$location","localStorageService","AuthenticationFactory","MerchantFactory","AdminFactory","AlertService","$modal",function(n,t,i,r,u,f,e,o,s){var h,k,d,c,l;o.clear();h={};h.userInfo=r.get("userInfo");h.salesDetails=null;h.balanceDetails=null;t.closeAlert=function(n){t.alerts.splice(n,1)};var a=function(){return{show:!0,title:"HOME",instruction:"Select category"}},v=function(){function e(r){switch(r){case"longdistance":n={show:!0,title:"Long Distance",instruction:u==="countries"?"Select Country":"Select Product"};break;case"international":n={show:!0,title:"International Top Up",instruction:u==="countries"?"Select Country":"Select Product"};break;case"pinless":n={show:!0,title:"Pinless",instruction:"Select Product"};break;case"wireless":n={show:!0,title:"Wireless",instruction:u==="carriers"?"Select Carrier":"Select Product"};break;case"promotions":n={show:!0,title:"Promotions",instruction:"Select Product"};break;default:n={show:i.path()==="/login"?!1:!0,title:t,instruction:"Select item"}}return n}var t=i.path().split("/").splice(1,1).toString(),r=i.path().split("/").splice(2,1).toString(),f=i.path().split("/").splice(3,1).toString(),u=i.path().split("/").splice(4,1).toString(),n={show:!0,title:t,instruction:"Select"+t.toUpperCase()};switch(t){case"pos":e(f);break;case"sunpass":n={show:!0,title:t,instruction:"Select "+t.toUpperCase()};break;case"billpayment":n={show:!0,title:"Bill Payment",instruction:r==="categories"?"Select Category":r==="category"?"Select Biller":"Complete the form"};break;case"others":n={show:!0,title:t,instruction:"Select item"};break;case"directtv":n={show:!0,title:"Direct Tv",instruction:r==="categories"?"Select Category":r==="category"?"Select Product":"Complete the form"};break;default:n={show:i.path()==="/login"?!1:!0,title:t,instruction:"Select item"}}return n},y=function(){return i.path()==="/"||i.path()==="/login"?!1:!0},p=function(){return i.path()==="/login"?!1:!0},w=function(){return i.path()==="/login"?!1:!0},b=function(){return r.get("userInfo")};t.viewInfo=i.path()==="/"?a():v();k=function(){var n=b();f.getSalesSummary(n.MerchantId,n.MerchantPassword).then(function(n){h.salesDetails=n},function(n){t.error=n;void 0})};d=function(){var n=b();h.userInfo=n;f.getBalanceDetails(n.MerchantId,n.MerchantPassword).then(function(n){h.balanceDetails=n;t.spin=!1},function(n){t.error=n;void 0})};t.openAccountModal=function(){var n=s.open({templateUrl:"./app/admin/_modal-account-tpl.html",controller:"ModalAccountCtrl",size:"lg",windowClass:"product-modal",resolve:{item:function(){return k(),d(),h}}});n.result.then(function(n){t.selected=n},function(){})};t.showHome=y();t.showAccount=p();t.showNav=w();c={title:"POS",logo:"http://mobile.blackstonepos.com/logos/pos-logo.png",favicon:"favicon.png"};l={title:"FCUSA",logo:"http://mobile.blackstonepos.com/logos/fullCarga.png",favicon:"favicon-fcusa.png"};h.userInfo&&h.userInfo.IsFullCarga?(t.comInfo=l,t.isFullCarga=!0):(t.comInfo=c,t.isFullCarga=!1);t.userInfo=h.userInfo;t.$watch(function(){return i.path()},function(n,i){n!==i&&(t.showHome=y(),t.showAccount=p(),t.showNav=w(),t.userInfo=r.get("userInfo"),t.isFullCarga=t.userInfo&&t.userInfo.IsFullCarga===!0?!0:!1,t.comInfo=t.userInfo&&t.userInfo.IsFullCarga===!0?l:c,t.viewInfo=n==="/"?a():v())},!0);t.$watch(u.isLoggedIn,function(n,t){!n&&t&&(void 0,i.path("/login"));n&&void 0},!0)}])}(),function(){"use strict";angular.module("posApp").directive("keypadNumeric",function(){return{restrict:"AE",replace:!0,templateUrl:"app/shared/_keypad-numeric.html",link:function(n,t){var i=t.find("a");i.on("click",function(){i.removeClass("active")})}}}).directive("topMenu",function(){return{restrict:"AE",replace:!0,templateUrl:"app/partials/top-menu.html",link:function(n,t){var i=t.find("a");i.on("click",function(){i.removeClass("active")})}}}).directive("productCaption",function(){return{restrict:"E",templateUrl:"app/directives/product-caption.html"}}).directive("salesDetails",function(){return{restrict:"A",templateUrl:"app/shared/_sales-details.html"}}).directive("workInProgress",function(){return{restrict:"A",templateUrl:"app/shared/_work-in-progress.html"}}).directive("countryFlag",function(){return{restrict:"E",replace:!0,template:'<span class="f24"> <span class="flag {{country.countryCode}}" data-cc="{{country.countryCode}}" data-country_name="{{country.countryCode}}"><\/span><\/span>'}}).directive("match",function(){return{require:"^ngModel",restrict:"A",scope:{match:"="},link:function(n,t,i,r){n.$watch(function(){return r.$pristine&&angular.isUndefined(r.$modelValue)||n.match===r.$modelValue},function(n){r.$setValidity("match",n)})}}}).directive("withkeypad",function(){return{require:"ngModel",restrict:"A",scope:{match:"="},link:function(n,t){var i;t.on("click",function(){i!==this&&(this.select(),i=this)});t.on("blur",function(){i=null})}}}).directive("ngAlertConfirm",[function(){return{link:function(n,t,i){var r=i.ngConfirmClick||"Are you sure?",u=i.confirmedClick;t.bind("click",function(){window.confirm(r)&&n.$eval(u)})}}}]).directive("numberFormatValidator",function(){var n=[/\d+/,/^\S+$/];return{require:"ngModel",link:function(t,i,r,u){u.$validators.numberFormat=function(t){var i=!0;return angular.forEach(n,function(n){i=i&&n.test(t)}),i}}}}).directive("money",function(){function t(t,i,r,u){function v(n){var t=Math.pow(10,f);return Math.round(n*t)/t}function l(n){return parseFloat(n).toFixed(f)}function a(n){return u.$isEmpty(n)?"":""+n}var c=parseFloat(r.min||0),f=parseFloat(r.precision||2),e,o,s,h;u.$parsers.push(function(t){angular.isUndefined(t)&&(t="");t.indexOf(".")===0&&(t="0"+t);t.indexOf("-")===0&&(c>=0?(t=null,u.$setViewValue(""),u.$render()):t==="-"&&(t=""));var i=u.$isEmpty(t);return i||n.test(t)?e=t===""?null:i?t:parseFloat(t):(u.$setViewValue(a(e)),u.$render()),u.$setValidity("number",!0),e});u.$formatters.push(a);o=function(n){return!u.$isEmpty(n)&&n<c?(u.$setValidity("min",!1),undefined):(u.$setValidity("min",!0),n)};u.$parsers.push(o);u.$formatters.push(o);s="";r.$observe("max",function(n){s=parseFloat(n)});h=function(n){return!u.$isEmpty(n)&&n>s?(u.$setValidity("max",!1),undefined):(u.$setValidity("max",!0),n)};u.$parsers.push(h);u.$formatters.push(h);f>-1&&(u.$parsers.push(function(n){return n?v(n):n}),u.$formatters.push(function(n){return n?l(n):n}));i.bind("blur",function(){var n=u.$modelValue;n&&(u.$viewValue=l(n),u.$render())})}var n=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/;return{restrict:"A",require:"ngModel",link:t}}).directive("emailValidator",function(){var n=[/^[a-zA-Z0-9._%-]+@[a-zA-Z0-9.-]+.[a-zA-Z]{2,4}$/,/^\S+$/];return{require:"ngModel",link:function(t,i,r,u){u.$validators.emailFormat=function(t){var i=!0;return angular.forEach(n,function(n){i=i&&n.test(t)}),i}}}}).directive("phoneValidator",function(){var n=[/^\([0-9]{3}\)[0-9]{3}-[0-9]{4}$/,/^[0-9]{10}$/];return{require:"ngModel",link:function(t,i,r,u){u.$validators.phoneFormat=function(t){var i=!0;return angular.forEach(n,function(n){i=i&&n.test(t)}),i}}}}).directive("phoneMatch",function(){return{restrict:"A",scope:!0,require:"ngModel",link:function(n,t,i,r){var u=function(){var t=n.$eval(i.ngModel),r=n.$eval(i.phoneMatch);return t===r};n.$watch(u,function(n){r.$setValidity("phonematch",n)})}}}).directive("accountMatch",function(){return{restrict:"A",scope:!0,require:"ngModel",link:function(n,t,i,r){var u=function(){var t=n.$eval(i.ngModel),r=n.$eval(i.accountMatch);return t===r};n.$watch(u,function(n){r.$setValidity("accountmatch",n)})}}}).directive("usaStates",function(){return{restrict:"E",templateUrl:'<select ng-options="state.abb as state.name for state in states"> <option value="">{{ emptyName }}<\/option> <\/select>',replace:!0,scope:!0,link:function(n,t,i){n.emptyName=i.emptyname||"Select State"},controller:["$scope",function(n){n.selectedState="";n.states=[{name:"Alabama",abb:"AL"},{name:"Alaska",abb:"AK"},{name:"Arizona",abb:"AZ"},{name:"Arkansas",abb:"AR"},{name:"California",abb:"CA"},{name:"Colorado",abb:"CO"},{name:"Connecticut",abb:"CT"},{name:"Delaware",abb:"DE"},{name:"District Of Columbia",abb:"DC"},{name:"Florida",abb:"FL"},{name:"Georgia",abb:"GA"},{name:"Hawaii",abb:"HI"},{name:"Idaho",abb:"ID"},{name:"Illinois",abb:"IL"},{name:"Indiana",abb:"IN"},{name:"Iowa",abb:"IA"},{name:"Kansas",abb:"KS"},{name:"Kentucky",abb:"KY"},{name:"Louisiana",abb:"LA"},{name:"Maine",abb:"ME"},{name:"Maryland",abb:"MD"},{name:"Massachusetts",abb:"MA"},{name:"Michigan",abb:"MI"},{name:"Minnesota",abb:"MN"},{name:"Mississippi",abb:"MS"},{name:"Missouri",abb:"MO"},{name:"Montana",abb:"MT"},{name:"Nebraska",abb:"NE"},{name:"Nevada",abb:"NV"},{name:"New Hampshire",abb:"NH"},{name:"New Jersey",abb:"NJ"},{name:"New Mexico",abb:"NM"},{name:"New York",abb:"NY"},{name:"North Carolina",abb:"NC"},{name:"North Dakota",abb:"ND"},{name:"Ohio",abb:"OH"},{name:"Oklahoma",abb:"OK"},{name:"Oregon",abb:"OR"},{name:"Pennsylvania",abb:"PA"},{name:"Rhode Island",abb:"RI"},{name:"South Carolina",abb:"SC"},{name:"South Dakota",abb:"SD"},{name:"Tennessee",abb:"TN"},{name:"Texas",abb:"TX"},{name:"Utah",abb:"UT"},{name:"Vermont",abb:"VT"},{name:"Virginia",abb:"VA"},{name:"Washington",abb:"WA"},{name:"West Virginia",abb:"WV"},{name:"Wisconsin",abb:"WI"},{name:"Wyoming",abb:"WY"}]}]}}).directive("img",function(){return{restrict:"E",link:function(n,t){t.bind("error",function(){var n=t.offsetWidth,i=t.offsetHeight,r;n<=20&&(n=100);i<=20&&(i=100);r="http://placehold.it/50x31?text=Image+not+found";t.prop("src",r)})}}}).directive("innerNavFilters",function(){return{restrict:"AE",replace:!0,templateUrl:"app/shared/_inner-nav.html",link:function(n){var t={show:"Show Filter",hide:"Hide Filter"};n.acronymText=n.showAcronym===!0?t.hide:t.show;n.clearDisabled=!0;n.showFilter=function(){n.showAcronym=!n.showAcronym;n.acronymText=n.showAcronym===!0?t.hide:t.show};n.clearFilter=function(){n.letter="";n.acronymDisabled=!1;n.clearDisabled=!0};n.setFilter=function(t){n.letter=t;n.clearDisabled=!1}}}})}(),function(){"use strict";angular.module("appFilters",[]).filter("capitalize",function(){return function(n){return n?n.replace(/([^\W_]+[^\s-]*) */g,function(n){return n.charAt(0).toUpperCase()+n.substr(1).toLowerCase()}):""}}).filter("makeSlug",function(){return function(n){return n=n||"",n.replace(/\s+/g,"-").toLowerCase()}}).filter("tel",function(){return function(n){var t,r,u,i;if(!n)return"";if(t=n.toString().trim().replace(/^\+/,""),t.match(/[^0-9]/))return n;switch(t.length){case 10:r=1;u=t.slice(0,3);i=t.slice(3);break;case 11:r=t[0];u=t.slice(1,4);i=t.slice(4);break;case 12:r=t.slice(0,3);u=t.slice(3,5);i=t.slice(5);break;default:return n}return r===1&&(r=""),i=i.slice(0,3)+"-"+i.slice(3),(r+" ("+u+") "+i).trim()}}).filter("ordinal",function(){return function(n){return n.charAt(0).toUpperCase()+n.substr(1).replace(/[A-Z]/g," $&")}}).filter("humanizeConstant",function(){return function(n){if(n){var t=n.split("_").join(" ").toLowerCase();return t.charAt(0).toUpperCase()+t.slice(1)}}}).filter("untilComa",function(){return function(n){if(!n||!n.length)return!1;var t=n.indexOf(",");return t===-1?n:n.substring(0,t)}}).filter("firstLetter",function(){return function(n,t){var r,f,i,u;if(!n||!n.length)return!1;for(r=[],f=new RegExp(t,"i"),i=0;i<n.length;i++)u=n[i],f.test(u.Name.substring(0,1))&&r.push(u);return r}}).filter("customCurrency",["$filter",function(n){return function(t,i){var r=n("currency");return t<0?r(t,i).replace("(","-").replace(")",""):r(t,i)}}])}(),function(){"use strict";angular.module("customFunctions",[]).factory("SharedFunctions",[function(){return{unique:function(n){for(var i={},r=[],t=0;t<n.length;t++)i[n[t]]=n[t];for(t in i)r.push(i[t]);return r},serialize:function(n){var i=[];for(var t in n)n.hasOwnProperty(t)&&i.push(encodeURIComponent(t)+"="+encodeURIComponent(n[t]));return i.join("&")},isobject:function(n){return!!n&&n.constructor===Object},alpha:function(){return["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"]},firstleter:function(n){for(var i=[],t=0;t<n.length;t++)i.push(n[t].Name.charAt(0));return i},isMobile:function(){return navigator.userAgent.match(/Android|BlackBerry|iPhone|iPad|iPod|Opera Mini|IEMobile/i)?!0:!1}}}])}(),function(){"use strict";angular.module("sharedServices",[]).factory("ExternalFactory",["$http","$rootScope","API_URL","$q","localStorageService","SharedFunctions",function(n,t,i,r,u,f){var o,s={tracker:t.loadingTracker},e=u.get("userInfo");return o=e!=null||f.isobject(e)?{MerchantId:e.MerchantId,MerchantPassword:e.MerchantPassword,PageNumber:null,PageSize:null}:{MerchantId:"834",MerchantPassword:"m5494"},{getActivationShopUrl:function(){var t=r.defer();return n.post(i+"admin/GetActivationExternalLogin",o,s).then(function(n){var i=n.data.Data;t.resolve(i)},function(n){t.reject(n);void 0}),t.promise},getVonageUrl:function(){var t=r.defer();return n.post(i+"admin/GetVonageExternalLogin",o,s).then(function(n){var i=n.data.Data;t.resolve(i)},function(n){t.reject(n);void 0}),t.promise}}}]).factory("ItemFactory",[function(){var n=[];return{selectObject:function(t){n=t},returnObject:function(){return n}}}]).factory("ConfirmationFactory",["$http","$rootScope","API_URL","$q","localStorageService",function(n,t,i,r,u){var f=[],o=u.get("userInfo"),e={MerchantId:o.MerchantId,MerchantPassword:o.MerchantPassword},s={tracker:t.loadingTracker};return{sendConfirmationSms:function(t,u){var h={PhoneNumber:u,Receipt:{ProductName:t.ProductName,ProductCountry:t.ProductCountry,CarrierName:t.CarrierName,ProductInstructions:t.ProductInstructions,PhoneNumber:t.PhoneNumber,PinNumber:t.PinNumber,ControlNumber:t.ControlNumber,OrderNumber:t.OrderNumber,TransactionId:t.TransactionId,UpdatedBalance:t.UpdatedBalance,MerchantName:t.MerchantName,MerchantPhoneNumber:t.MerchantPhoneNumber,CashierName:t.CashierName,MerchantAddress:t.MerchantAddress,OrderDate:t.OrderDate,Amount:t.Amount,Fee:t.Fee,Tax:t.Tax,Total:t.Total},MerchantId:e.MerchantId,MerchantPassword:e.MerchantPassword},o;return void 0,o=r.defer(),n.post(i+"ReceiptServices/SendConfirmationSms",h,s).then(function(n){f=n.data;o.resolve(f)},function(n){void 0;o.reject(n)}),o.promise},sendConfirmationEmail:function(t,u){var h={Email:u,Receipt:{ProductName:t.ProductName,ProductCountry:t.ProductCountry,CarrierName:t.CarrierName,ProductInstructions:t.ProductInstructions,PhoneNumber:t.PhoneNumber,PinNumber:t.PinNumber,ControlNumber:t.ControlNumber,OrderNumber:t.OrderNumber,TransactionId:t.TransactionId,UpdatedBalance:t.UpdatedBalance,MerchantName:t.MerchantName,MerchantPhoneNumber:t.MerchantPhoneNumber,CashierName:t.CashierName,MerchantAddress:t.MerchantAddress,OrderDate:t.OrderDate,Amount:t.Amount,Fee:t.Fee,Tax:t.Tax,Total:t.Total},MerchantId:e.MerchantId,MerchantPassword:e.MerchantPassword},o=r.defer();return n.post(i+"ReceiptServices/SendConfirmationEmail",h,s).then(function(n){f=n.data;o.resolve(f)},function(n){void 0;o.reject(n)}),o.promise}}}]).factory("AlertService",["$rootScope",function(n){var t={};return n.alerts=[],t.add=function(i,r){n.alerts.push({type:i,msg:r,close:function(){t.closeAlert(this)}})},t.closeAlert=function(i){t.closeAlertIdx(n.alerts.indexOf(i))},t.closeAlertIdx=function(t){n.alerts.splice(t,1)},t.clear=function(){n.alerts=[]},t.getAlertInstance=function(n){var i=n.Status,t=n.ErrorMessage;return{type:i===200?"success":"error",msg:t===""?"The Operation was completed successfuly":t}},t}])}(),function(){"use strict";angular.module("posApp").controller("IndexSunpassCtrl",["$scope","AlertService",function(n,t){t.clear();n.items=[{categoryName:"sunpass",title:"Activate or Replenish Sunpass",url:"#/sunpass/category/replenish",position:0,icon:""},{categoryName:"sunpass",title:"Pay Your Document",url:"#/sunpass/category/documents",position:1,icon:""}]}]).controller("ReplenishSunpassCtrl",["$scope","$routeParams","SunpassFactory","AlertService","SharedFunctions","ConfirmationFactory",function(n,t,i,r,u,f){function o(){var t=n.accountNumber.value.length,i=n.accountNumber.value;n.accountNumber.value=i.substring(0,t-1)}function s(){var t=n.accountMatch.value.length,i=n.accountMatch.value;void 0;void 0;n.accountMatch.value=i.substring(0,t-1)}function h(){var t=n.amount.value.length,i=n.amount.value;void 0;void 0;n.amount.value=i.substring(0,t-1)}function c(t){n.accountNumber.value=n.accountNumber.value+t}function l(t){void 0;n.accountMatch.value=n.accountMatch.value+t}function a(t){n.amount.value=n.amount.value+t}function e(){n.accountNumber.value||(n.accountNumber.value="");n.accountMatch.value||(n.accountMatch.value="");n.amount.value||(n.amount.value="")}function v(t){void 0;n.amount.isFocused?a(t):n.accountNumber.isFocused?c(t):l(t)}r.clear();n.item={name:"Activate or Replenish Sunpass Transponder",MaxAmount:100};n.hasKeyPad=!0;n.showKeypad=!0;n.showPaymentDetails=!1;n.showDoReplenishment=!1;n.showReceipt=!1;n.showToCategories=!1;n.showToReplenish=!1;n.accountNumber={value:null,isFocused:!1};n.accountMatch={value:null,isFocused:!1};n.amount={value:null,isFocused:!1};n.submitted=!1;n.editing=null;n.editItem=function(t){n.editing=t;void 0};n.onInputClick=function(n){n.target.select()};n.setKey=function(n){e();v(n)};n.clearKey=function(){n.accountNumber.isFocused?n.accountNumber.value="":n.amount.value=""};n.backKey=function(){e();n.accountNumber.isFocused?o():n.amount.isFocused?h():s()};n.setFocusedInput=function(t){t==="amount"?(n.accountNumber.isFocused=!1,n.accountMatch.isFocused=!1,n.amount.isFocused=!0,void 0):t==="accountNumber"?(n.accountMatch.isFocused=!1,n.accountNumber.isFocused=!0,n.amount.isFocused=!1,void 0):t==="accountMatch"&&(n.accountNumber.isFocused=!1,n.accountMatch.isFocused=!0,n.amount.isFocused=!1,void 0)};n.leaveInputsFocus=function(){n.accountNumber.isFocused=!1;n.accountMatch.isFocused=!1;n.amount.isFocused=!1};n.doGetInfo=function(t){if(n.submitted=!0,t.$invalid){r.clear();r.add("error","Check errors below (in red color)");return}var u=n.accountNumber.value;i.getSunpassTransporderInfo(u).then(function(t){t.Status===200?(n.isDisableInputs=!0,n.aditionalDataRequired=t.Data,n.showPaymentDetails=!0,n.showDoReplenishment=!0,n.submitted=!1):(r.clear(),r.add("error",t.ErrorMessage),n.isDisableInputs=!1)},function(){void 0})};n.doReplenishment=function(t){if(n.submitted=!0,t.$invalid){r.clear();r.add("error","Check errors below (in red color)");return}var u={TransporderNumber:n.accountNumber.value,PurchaseId:n.aditionalDataRequired.purchaseIdField,Amount:n.amount.value};void 0;i.doSunpassReplenishment(u).then(function(t){t.Status===200||t.Status===203?(n.isDisableInputs=!0,n.receipt=t.Data,n.showPaymentDetails=!0,n.showDoReplenishment=!1,n.showReceipt=!0,n.showToCategories=!0,n.showToReplenish=!0):(r.clear(),r.add("error",t.ErrorMessage),n.isDisableInputs=!1)},function(){void 0})};n.printInfo=function(){window.print()};n.sendSms=function(t){if(n.submittedSms=!0,t.$invalid){r.clear();r.add("error","Check form errors");return}r.clear();var i=n.receipt,u=n.phoneToSend;f.sendConfirmationSms(i,u).then(function(t){r.clear();n.submittedSms=!1;t.Status===200?r.add("success","The Receipt has been sent as sms successfully!"):r.add("error","Sorry, an error has happened. Please, try again.");void 0},function(n){r.add("error",n.ErrorMessage);void 0})};n.sendEmail=function(t){if(n.submittedEmail=!0,t.$invalid){r.clear();r.add("error","Check form errors");return}r.clear();var i=n.receipt,u=n.emailToSend;f.sendConfirmationEmail(i,u).then(function(t){r.clear();n.submittedEmail=!1;t.Status===200?r.add("success","The Receipt has been sent as email successfully!"):r.add("error","Sorry, an error has happened. Please, try again.");void 0},function(n){r.add("error",n.ErrorMessage);void 0})}}]).controller("DocumentsSunpassCtrl",["$scope","$routeParams","SunpassFactory","AlertService","localStorageService","SharedFunctions","ConfirmationFactory",function(n,t,i,r,u,f,e){n.item={name:"Pay Your Documents"};n.showCheck=!0;n.showPaymentDetails=!1;n.showFieldsDescription=!0;n.showDoDocumentsPayment=!1;n.showReceipt=!1;n.submittedCheck=!1;n.submittedDoPayment=!1;n.idnumber=null;n.plate=null;n.total=0;n.fee=0;n.selectedDocuments=[];n.submitted=!1;n.parseFloat=function(n){return parseFloat(n)};n.setDocument=function(t,i){n.selectedDocuments=t;n.active=!n.active;var r=0;angular.forEach(t,function(n){r=r+parseFloat(n.documentPaymentAmountField)});n.total=r+parseFloat(n.fee);n.paymentType=i;void 0;void 0;void 0};n.doGetInfo=function(t){if(n.submittedCheck=!0,t.$invalid){r.clear();r.add("error","Check errors below (in red color)");return}var u={DocumentId:n.idnumber,LicensePlate:n.plate};void 0;i.getSunpassDocumentsInfo(u).then(function(t){t.Status===200?(n.documents=t.Data,n.fee=t.Data.fee,void 0,n.isDisableInputs=!0,n.showCheck=!1,n.showFieldsDescription=!1,n.showPaymentDetails=!0,n.showDoDocumentsPayment=!0):(r.clear(),r.add("error",t.ErrorMessage),n.isDisableInputs=!1,n.showCheck=!0)},function(){void 0})};n.doDocumentsPayment=function(t){if(void 0,n.submittedDoPayment=!0,t.$invalid){r.clear();r.add("error","Check errors below (in red color)");return}var u={DocumentId:n.idnumber,LicencePlate:n.plate,PaymentType:n.paymentType};void 0;i.doSunPassDocumentsPayment(u).then(function(t){t.Status===200||t.Status===203?(n.showReceipt=!0,n.receipt=t.Data):(r.clear(),r.add("error",t.ErrorMessage),n.isDisableInputs=!1)},function(){void 0})};n.printInfo=function(){window.print()};n.sendSms=function(t){if(n.submittedSms=!0,t.$invalid){r.clear();r.add("error","Check form errors");return}r.clear();var i=n.receipt,u=n.phoneToSend;e.sendConfirmationSms(i,u).then(function(t){r.clear();n.submittedSms=!1;t.Status===200?r.add("success","The Receipt has been sent as sms successfully!"):r.add("error","Sorry, an error has happened. Please, try again.")},function(n){r.add("error",n.ErrorMessage)})};n.sendEmail=function(t){if(n.submittedEmail=!0,t.$invalid){r.clear();r.add("error","Check form errors");return}r.clear();var i=n.receipt,u=n.emailToSend;e.sendConfirmationEmail(i,u).then(function(t){r.clear();n.submittedEmail=!1;t.Status===200?r.add("success","The Receipt has been sent as email successfully!"):r.add("error","Sorry, an error has happened. Please, try again.")},function(n){r.add("error",n.ErrorMessage)})}}])}(),function(){"use strict";angular.module("sunpassServices",[]).factory("SunpassFactory",["$http","$rootScope","API_URL","$q","SharedFunctions","localStorageService",function(n,t,i,r,u,f){var e=[],h=f.get("userInfo"),o={MerchantId:h.MerchantId,MerchantPassword:h.MerchantPassword},s={tracker:t.loadingTracker};return{getSunpassTransporderInfo:function(t){var f={MerchantId:o.MerchantId,MerchantPassword:o.MerchantPassword,TransporderNumber:t},u=r.defer();return n.post(i+"SunPass/GetSunpassTransporderInfo",f,s).then(function(n){e=n.data;u.resolve(e)},function(n){u.reject(n)}),u.promise},doSunpassReplenishment:function(t){var f={MerchantId:o.MerchantId,MerchantPassword:o.MerchantPassword,TransporderNumber:t.TransporderNumber,PurchaseId:t.PurchaseId,Amount:t.Amount},u=r.defer();return n.post(i+"SunPass/DoSunpassReplenishment",f,s).then(function(n){e=n.data;u.resolve(e)},function(n){u.reject(n)}),u.promise},getSunpassDocumentsInfo:function(t){var f={LicensePlate:t.LicensePlate,DocumentId:t.DocumentId,MerchantId:o.MerchantId,MerchantPassword:o.MerchantPassword},u=r.defer();return n.post(i+"SunPass/GetSunpassDocumentsInfo",f,s).then(function(n){e=n.data;u.resolve(e)},function(n){u.reject(n)}),u.promise},doSunPassDocumentsPayment:function(t){var f={MerchantId:o.MerchantId,MerchantPassword:o.MerchantPassword,PaymentType:t.PaymentType,DocumentId:t.DocumentId,LicensePlate:t.LicencePlate},u=r.defer();return n.post(i+"SunPass/DoSunPassDocumentsPayment",f,s).then(function(n){e=n.data;u.resolve(e)},function(n){u.reject(n)}),u.promise}}}])}();
//# sourceMappingURL=scripts.min.js.map
